<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shriya Chinthak">
<meta name="dcterms.date" content="2023-11-11">

<title>Time Series - Shriya Chinthak - hw4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Time Series - Shriya Chinthak</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://shriya-chinthak.georgetown.domains" rel="" target="">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html" rel="" target="">
 <span class="menu-text">Introduction</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">hw4</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-vizes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Vizes in TS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Sources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARMA/ARIMA/SARIMA Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arimax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARIMAX/SARIMAX/VAR</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./saf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Analysis and Filtering</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial-ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deep-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep Learning for TS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conclusions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#converting-to-time-series" id="toc-converting-to-time-series" class="nav-link active" data-scroll-target="#converting-to-time-series">Converting to Time Series</a></li>
  <li><a href="#visualizing-the-data" id="toc-visualizing-the-data" class="nav-link" data-scroll-target="#visualizing-the-data">Visualizing the data:</a></li>
  <li><a href="#varselect" id="toc-varselect" class="nav-link" data-scroll-target="#varselect">VARselect</a></li>
  <li><a href="#initial-selection" id="toc-initial-selection" class="nav-link" data-scroll-target="#initial-selection">Initial selection:</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross Validation:</a></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">Forecasting:</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">part 2:</a>
  <ul class="collapse">
  <li><a href="#varselect-1" id="toc-varselect-1" class="nav-link" data-scroll-target="#varselect-1">VARselect</a></li>
  <li><a href="#initial-selection-1" id="toc-initial-selection-1" class="nav-link" data-scroll-target="#initial-selection-1">Initial selection:</a></li>
  <li><a href="#cross-validation-1" id="toc-cross-validation-1" class="nav-link" data-scroll-target="#cross-validation-1">Cross Validation:</a></li>
  <li><a href="#model-creation" id="toc-model-creation" class="nav-link" data-scroll-target="#model-creation">Model Creation:</a></li>
  <li><a href="#forecasting-1" id="toc-forecasting-1" class="nav-link" data-scroll-target="#forecasting-1">Forecasting:</a></li>
  </ul></li>
  <li><a href="#part-3" id="toc-part-3" class="nav-link" data-scroll-target="#part-3">Part 3:</a>
  <ul class="collapse">
  <li><a href="#gathering-the-data" id="toc-gathering-the-data" class="nav-link" data-scroll-target="#gathering-the-data">Gathering the Data</a></li>
  <li><a href="#using-auto.arima" id="toc-using-auto.arima" class="nav-link" data-scroll-target="#using-auto.arima">Using Auto.Arima()</a></li>
  <li><a href="#manually-finding-the-model" id="toc-manually-finding-the-model" class="nav-link" data-scroll-target="#manually-finding-the-model">Manually Finding the Model:</a></li>
  <li><a href="#cv" id="toc-cv" class="nav-link" data-scroll-target="#cv">CV</a></li>
  <li><a href="#forecasting-2" id="toc-forecasting-2" class="nav-link" data-scroll-target="#forecasting-2">Forecasting:</a></li>
  </ul></li>
  <li><a href="#sarima" id="toc-sarima" class="nav-link" data-scroll-target="#sarima">SARIMA:</a>
  <ul class="collapse">
  <li><a href="#seasonal-anlysis" id="toc-seasonal-anlysis" class="nav-link" data-scroll-target="#seasonal-anlysis">Seasonal Anlysis</a></li>
  <li><a href="#determining-the-model" id="toc-determining-the-model" class="nav-link" data-scroll-target="#determining-the-model">Determining the Model</a></li>
  <li><a href="#fitting-the-model-and-forecasting" id="toc-fitting-the-model-and-forecasting" class="nav-link" data-scroll-target="#fitting-the-model-and-forecasting">Fitting the Model and Forecasting</a></li>
  </ul></li>
  <li><a href="#homework-5" id="toc-homework-5" class="nav-link" data-scroll-target="#homework-5">Homework 5:</a>
  <ul class="collapse">
  <li><a href="#using-auto.arima-1" id="toc-using-auto.arima-1" class="nav-link" data-scroll-target="#using-auto.arima-1">Using auto.arima</a></li>
  <li><a href="#manual-ararmaarima-model" id="toc-manual-ararmaarima-model" class="nav-link" data-scroll-target="#manual-ararmaarima-model">Manual AR/ARMA/ARIMA Model</a></li>
  <li><a href="#archgarch" id="toc-archgarch" class="nav-link" data-scroll-target="#archgarch">ARCH/GARCH</a></li>
  <li><a href="#equation" id="toc-equation" class="nav-link" data-scroll-target="#equation">Equation:</a></li>
  <li><a href="#using-auto.arima-2" id="toc-using-auto.arima-2" class="nav-link" data-scroll-target="#using-auto.arima-2">Using auto.arima</a></li>
  <li><a href="#manual-ararmaarima-model-1" id="toc-manual-ararmaarima-model-1" class="nav-link" data-scroll-target="#manual-ararmaarima-model-1">Manual AR/ARMA/ARIMA Model</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">hw4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shriya Chinthak </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.warning4.0"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.yahoo.warning"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tickers <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"UMGP"</span>, <span class="st">"WMG"</span>, <span class="st">"352820.KS"</span>, <span class="st">"041510.KQ"</span>, <span class="st">'122870.KQ'</span>, <span class="st">'035900.KQ'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tickers){</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getSymbols</span>(i, <span class="at">from =</span> <span class="st">"2000-01-01"</span>, <span class="at">to =</span> <span class="st">"2023-09-01"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(UMGP<span class="sc">$</span>UMGP.Adjusted)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> UMGP <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">UMGP_Price =</span> UMGP.Adjusted)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(UMGP<span class="sc">$</span>Date))  </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(UMGP<span class="sc">$</span>Date))    </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> <span class="fu">merge</span>(UMGP, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> UMGP[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(UMGP)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> UMGP[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(UMGP)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(UMGP, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>WMG <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(WMG<span class="sc">$</span>WMG.Adjusted)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>WMG <span class="ot">&lt;-</span> WMG <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">WMG_Price =</span> WMG.Adjusted)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(WMG<span class="sc">$</span>Date))  </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(WMG<span class="sc">$</span>Date))    </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>WMG <span class="ot">&lt;-</span> <span class="fu">merge</span>(WMG, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> WMG[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(WMG)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> WMG[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(WMG)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(WMG, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>WMG <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">352820.KS</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">352820.KS.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> HYBE <span class="sc">%&gt;%</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">HYBE_Price =</span> X352820.KS.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HYBE_Price =</span> HYBE_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(HYBE<span class="sc">$</span>Date))  </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(HYBE<span class="sc">$</span>Date))    </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> <span class="fu">merge</span>(HYBE, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> HYBE[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(HYBE)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> HYBE[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(HYBE)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(HYBE, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co">#--- </span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">041510.KQ</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">041510.KQ.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> SM <span class="sc">%&gt;%</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SM_Price =</span> X041510.KQ.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SM_Price =</span> SM_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(SM<span class="sc">$</span>Date))  </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(SM<span class="sc">$</span>Date))    </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> <span class="fu">merge</span>(SM, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> SM[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(SM)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> SM[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(SM)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(SM, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">122870.KQ</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">122870.KQ.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> YG <span class="sc">%&gt;%</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">YG_Price =</span> X122870.KQ.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YG_Price =</span> YG_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(YG<span class="sc">$</span>Date))  </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(YG<span class="sc">$</span>Date))    </span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> <span class="fu">merge</span>(YG, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> YG[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(YG)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> YG[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(YG)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(YG, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">035900.KQ</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">035900.KQ.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> JYP <span class="sc">%&gt;%</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">JYP_Price =</span> X035900.KQ.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">JYP_Price =</span> JYP_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(JYP<span class="sc">$</span>Date))  </span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(JYP<span class="sc">$</span>Date))    </span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> <span class="fu">merge</span>(JYP, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> JYP[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(JYP)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> JYP[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(JYP)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(JYP, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>stock_dataframes <span class="ot">&lt;-</span> <span class="fu">list</span>(UMGP, WMG, HYBE, SM, YG, JYP)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>stock_names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"UMGP"</span>, <span class="st">"WMG"</span>, <span class="st">"HYBE"</span>, <span class="st">"SM"</span>, <span class="st">"YG"</span>, <span class="st">"JYP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a subset of only Korean Record label stock data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> HYBE <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(SM, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(YG, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(JYP, <span class="at">by =</span> <span class="st">'Date'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="converting-to-time-series" class="level3">
<h3 class="anchored" data-anchor-id="converting-to-time-series">Converting to Time Series</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hybe <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>HYBE_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sm <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>SM_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>yg <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>YG_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>jyp <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>JYP_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hybe, sm, yg, jyp)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_ts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hybe"</span>, <span class="st">"sm"</span>, <span class="st">"yg"</span>, <span class="st">"jyp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualizing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-data">Visualizing the data:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(df_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we previously mentioned in data visualization, HYBE seems to have a much larger impact in comparison to the other three record companies on the stock market overall. However, what we can see is that several of the positive trends shown through all stock prices, thus we can note some initial correlation. Let’s continue with the VAR model to see what the multivariate relationship is.</p>
</section>
<section id="varselect" class="level3">
<h3 class="anchored" data-anchor-id="varselect">VARselect</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(df_ts, <span class="at">lag.max=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
     5      1      1      5 

$criteria
               1         2         3         4         5         6         7
AIC(n)  3.142389  3.114099  3.117499  3.112310  3.088174  3.092878  3.107702
HQ(n)   3.185625  3.186159  3.218383  3.242018  3.246706  3.280234  3.323882
SC(n)   3.256375  3.304076  3.383466  3.454268  3.506123  3.586817  3.677632
FPE(n) 23.159131 22.513187 22.589948 22.473198 21.937533 22.041324 22.370993
               8         9        10
AIC(n)  3.111249  3.118763  3.131486
HQ(n)   3.356254  3.392591  3.434139
SC(n)   3.757171  3.840675  3.929389
FPE(n) 22.451153 22.621304 22.912010</code></pre>
</div>
</div>
<p>We can see that the p-values detected from VARselect() are 5 and 1.</p>
</section>
<section id="initial-selection" class="level3">
<h3 class="anchored" data-anchor-id="initial-selection">Initial selection:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, sm, yg, jyp 
Deterministic variables: both 
Sample size: 1051 
Log Likelihood: -7636.31 
Roots of the characteristic polynomial:
0.9954 0.9902 0.9811 0.9811
Call:
vars::VAR(y = df_ts, p = 1, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.9908097  0.0048019 206.337   &lt;2e-16 ***
sm.l1    0.0022993  0.0195271   0.118    0.906    
yg.l1    0.0622194  0.0400453   1.554    0.121    
jyp.l1  -0.0302953  0.0197591  -1.533    0.126    
const   -0.0663658  0.8191955  -0.081    0.935    
trend    0.0005578  0.0014217   0.392    0.695    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.582 on 1045 degrees of freedom
Multiple R-Squared: 0.9909, Adjusted R-squared: 0.9909 
F-statistic: 2.277e+04 on 5 and 1045 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation sm: 
=================================== 
sm = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0036634  0.0017083   2.145   0.0322 *  
sm.l1    0.9801908  0.0069467 141.101   &lt;2e-16 ***
yg.l1   -0.0231121  0.0142460  -1.622   0.1050    
jyp.l1   0.0110615  0.0070293   1.574   0.1159    
const    0.3284611  0.2914272   1.127   0.2600    
trend    0.0011339  0.0005058   2.242   0.0252 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.63 on 1045 degrees of freedom
Multiple R-Squared: 0.994,  Adjusted R-squared: 0.994 
F-statistic: 3.491e+04 on 5 and 1045 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation yg: 
=================================== 
yg = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0005472  0.0010454   0.523   0.6008    
sm.l1    0.0025344  0.0042514   0.596   0.5512    
yg.l1    0.9868482  0.0087185 113.190   &lt;2e-16 ***
jyp.l1  -0.0007041  0.0043019  -0.164   0.8700    
const    0.2949613  0.1783516   1.654   0.0985 .  
trend    0.0001396  0.0003095   0.451   0.6520    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.9976 on 1045 degrees of freedom
Multiple R-Squared: 0.986,  Adjusted R-squared: 0.9859 
F-statistic: 1.471e+04 on 5 and 1045 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation jyp: 
==================================== 
jyp = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0005536  0.0011980   0.462 0.644124    
sm.l1   -0.0135935  0.0048718  -2.790 0.005363 ** 
yg.l1    0.0167605  0.0099909   1.678 0.093729 .  
jyp.l1   0.9896949  0.0049297 200.762  &lt; 2e-16 ***
const   -0.2443391  0.2043815  -1.196 0.232161    
trend    0.0012519  0.0003547   3.530 0.000434 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.143 on 1045 degrees of freedom
Multiple R-Squared: 0.9966, Adjusted R-squared: 0.9966 
F-statistic: 6.159e+04 on 5 and 1045 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
       hybe     sm     yg    jyp
hybe 20.996 2.1862 2.1450 1.8659
sm    2.186 2.6572 0.7519 0.9340
yg    2.145 0.7519 0.9952 0.7025
jyp   1.866 0.9340 0.7025 1.3069

Correlation matrix of residuals:
       hybe     sm     yg    jyp
hybe 1.0000 0.2927 0.4692 0.3562
sm   0.2927 1.0000 0.4624 0.5012
yg   0.4692 0.4624 1.0000 0.6160
jyp  0.3562 0.5012 0.6160 1.0000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, sm, yg, jyp 
Deterministic variables: both 
Sample size: 1047 
Log Likelihood: -7463.522 
Roots of the characteristic polynomial:
0.9936 0.9907 0.9741 0.9741 0.6725 0.6725 0.6258 0.6258 0.5949 0.5705 0.5705 0.5578 0.5578 0.553 0.4157 0.4157 0.362 0.362 0.2872 0.09888
Call:
vars::VAR(y = df_ts, p = 5, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.8597953  0.0355589  24.179  &lt; 2e-16 ***
sm.l1   -0.0845122  0.0985933  -0.857  0.39155    
yg.l1    0.1053591  0.1874006   0.562  0.57409    
jyp.l1   0.0478898  0.1612418   0.297  0.76652    
hybe.l2  0.1418576  0.0470883   3.013  0.00265 ** 
sm.l2    0.0710565  0.1387798   0.512  0.60876    
yg.l2   -0.0204218  0.2498248  -0.082  0.93487    
jyp.l2   0.0673012  0.2132995   0.316  0.75243    
hybe.l3  0.1008928  0.0474237   2.127  0.03362 *  
sm.l3    0.1305088  0.1397295   0.934  0.35052    
yg.l3   -0.1482943  0.2519800  -0.589  0.55632    
jyp.l3  -0.2200135  0.2140360  -1.028  0.30423    
hybe.l4  0.0367459  0.0459422   0.800  0.42399    
sm.l4    0.0086685  0.1398948   0.062  0.95060    
yg.l4   -0.2691600  0.2509303  -1.073  0.28368    
jyp.l4   0.1964530  0.2111857   0.930  0.35247    
hybe.l5 -0.1487634  0.0337524  -4.407 1.16e-05 ***
sm.l5   -0.1202141  0.0998846  -1.204  0.22905    
yg.l5    0.3805559  0.1889051   2.015  0.04421 *  
jyp.l5  -0.1128827  0.1602207  -0.705  0.48125    
const    0.4715235  0.7981067   0.591  0.55478    
trend   -0.0002577  0.0013922  -0.185  0.85317    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.319 on 1025 degrees of freedom
Multiple R-Squared: 0.9921, Adjusted R-squared: 0.9919 
F-statistic:  6101 on 21 and 1025 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation sm: 
=================================== 
sm = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0114542  0.0134067   0.854  0.39310    
sm.l1    0.9790130  0.0371724  26.337  &lt; 2e-16 ***
yg.l1   -0.1442679  0.0706553  -2.042  0.04142 *  
jyp.l1  -0.0175303  0.0607927  -0.288  0.77313    
hybe.l2 -0.0084490  0.0177536  -0.476  0.63425    
sm.l2    0.0736360  0.0523239   1.407  0.15964    
yg.l2    0.1218543  0.0941910   1.294  0.19606    
jyp.l2  -0.0382295  0.0804199  -0.475  0.63462    
hybe.l3 -0.0002227  0.0178801  -0.012  0.99006    
sm.l3    0.0244439  0.0526820   0.464  0.64275    
yg.l3    0.0541715  0.0950036   0.570  0.56866    
jyp.l3  -0.0345022  0.0806976  -0.428  0.66907    
hybe.l4  0.0101214  0.0173215   0.584  0.55913    
sm.l4   -0.1002341  0.0527443  -1.900  0.05766 .  
yg.l4   -0.0253390  0.0946078  -0.268  0.78888    
jyp.l4   0.1016257  0.0796230   1.276  0.20213    
hybe.l5 -0.0094405  0.0127256  -0.742  0.45835    
sm.l5   -0.0011058  0.0376593  -0.029  0.97658    
yg.l5   -0.0209738  0.0712226  -0.294  0.76845    
jyp.l5  -0.0024879  0.0604077  -0.041  0.96716    
const    0.1965731  0.3009087   0.653  0.51373    
trend    0.0013967  0.0005249   2.661  0.00791 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.628 on 1025 degrees of freedom
Multiple R-Squared: 0.9941, Adjusted R-squared: 0.994 
F-statistic:  8268 on 21 and 1025 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation yg: 
=================================== 
yg = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1 -1.266e-03  8.096e-03  -0.156 0.875731    
sm.l1   -4.700e-03  2.245e-02  -0.209 0.834207    
yg.l1    8.482e-01  4.267e-02  19.881  &lt; 2e-16 ***
jyp.l1   8.270e-03  3.671e-02   0.225 0.821811    
hybe.l2  2.944e-03  1.072e-02   0.275 0.783682    
sm.l2   -2.157e-02  3.160e-02  -0.683 0.494890    
yg.l2    2.194e-01  5.688e-02   3.857 0.000122 ***
jyp.l2  -4.823e-03  4.856e-02  -0.099 0.920899    
hybe.l3  2.151e-03  1.080e-02   0.199 0.842116    
sm.l3    4.958e-02  3.181e-02   1.558 0.119453    
yg.l3    1.158e-03  5.737e-02   0.020 0.983902    
jyp.l3   6.828e-03  4.873e-02   0.140 0.888594    
hybe.l4  2.441e-03  1.046e-02   0.233 0.815503    
sm.l4   -3.504e-02  3.185e-02  -1.100 0.271569    
yg.l4    2.502e-03  5.713e-02   0.044 0.965078    
jyp.l4   8.681e-03  4.808e-02   0.181 0.856762    
hybe.l5 -5.463e-03  7.684e-03  -0.711 0.477337    
sm.l5    1.507e-02  2.274e-02   0.662 0.507801    
yg.l5   -9.023e-02  4.301e-02  -2.098 0.036153 *  
jyp.l5  -1.735e-02  3.648e-02  -0.476 0.634446    
const    3.983e-01  1.817e-01   2.192 0.028616 *  
trend    4.017e-05  3.170e-04   0.127 0.899178    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.9834 on 1025 degrees of freedom
Multiple R-Squared: 0.9866, Adjusted R-squared: 0.9863 
F-statistic:  3591 on 21 and 1025 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation jyp: 
==================================== 
jyp = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0006532  0.0091949   0.071  0.94338    
sm.l1   -0.0145845  0.0254945  -0.572  0.56740    
yg.l1   -0.0662954  0.0484585  -1.368  0.17158    
jyp.l1   0.8855542  0.0416943  21.239  &lt; 2e-16 ***
hybe.l2 -0.0014774  0.0121762  -0.121  0.90345    
sm.l2   -0.0432859  0.0358860  -1.206  0.22802    
yg.l2    0.1533706  0.0646002   2.374  0.01777 *  
jyp.l2   0.1381693  0.0551555   2.505  0.01240 *  
hybe.l3  0.0088203  0.0122629   0.719  0.47214    
sm.l3    0.0991813  0.0361316   2.745  0.00616 ** 
yg.l3   -0.1022738  0.0651575  -1.570  0.11681    
jyp.l3  -0.0491761  0.0553459  -0.889  0.37447    
hybe.l4 -0.0071445  0.0118798  -0.601  0.54771    
sm.l4   -0.1109944  0.0361743  -3.068  0.00221 ** 
yg.l4    0.1607349  0.0648861   2.477  0.01340 *  
jyp.l4   0.0908549  0.0546088   1.664  0.09647 .  
hybe.l5 -0.0001754  0.0087278  -0.020  0.98397    
sm.l5    0.0571925  0.0258284   2.214  0.02703 *  
yg.l5   -0.1325737  0.0488475  -2.714  0.00676 ** 
jyp.l5  -0.0738799  0.0414302  -1.783  0.07484 .  
const   -0.1891913  0.2063761  -0.917  0.35950    
trend    0.0011485  0.0003600   3.190  0.00146 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.117 on 1025 degrees of freedom
Multiple R-Squared: 0.9968, Adjusted R-squared: 0.9968 
F-statistic: 1.531e+04 on 21 and 1025 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
       hybe     sm     yg    jyp
hybe 18.656 2.1148 2.0584 1.8330
sm    2.115 2.6519 0.7396 0.9206
yg    2.058 0.7396 0.9670 0.6693
jyp   1.833 0.9206 0.6693 1.2474

Correlation matrix of residuals:
       hybe     sm     yg    jyp
hybe 1.0000 0.3007 0.4846 0.3800
sm   0.3007 1.0000 0.4619 0.5061
yg   0.4846 0.4619 1.0000 0.6094
jyp  0.3800 0.5061 0.6094 1.0000</code></pre>
</div>
</div>
<p>We can see that based on the residual standard error and number of significant variables in the model, we can say that the model when p=5 performs better than when p=1. We can also notice that while HYBE and SM don’t see to have much correlation with other agencies, JYP and YG seem to be heavily correlated with each other and SM.</p>
<p>Thus, before we continue with the model, we will also verify through a CV test.</p>
</section>
<section id="cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation">Cross Validation:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">=</span> <span class="dv">5</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>best_performance <span class="ot">&lt;-</span> <span class="cn">Inf</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>fold_s <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">nrow</span>(df_ts)<span class="sc">/</span>folds)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>folds){</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">&lt;-</span> (fold<span class="dv">-1</span>)<span class="sc">*</span>fold_s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  end <span class="ot">&lt;-</span> fold<span class="sc">*</span>fold_s</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  train_model <span class="ot">&lt;-</span> df_ts[<span class="sc">-</span>(start<span class="sc">:</span>end), ]</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  test_model <span class="ot">&lt;-</span> df_ts[start<span class="sc">:</span>end, ]</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  sel <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(train_model, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"both"</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  best_lag <span class="ot">&lt;-</span> sel<span class="sc">$</span>selection[<span class="dv">1</span>]</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(train_model, <span class="at">p=</span>best_lag, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">nrow</span>(test_model)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> h)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  pred_hybe <span class="ot">&lt;-</span> pred<span class="sc">$</span>fcst<span class="sc">$</span>hybe[,<span class="dv">1</span>]</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_hybe <span class="sc">-</span> test_model[, <span class="st">"hybe"</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(mse <span class="sc">&lt;</span> best_performance){</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> fit</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    best_performance <span class="ot">&lt;-</span> mse</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The best model is: "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The best model is: "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
======================= 

Estimated coefficients for equation hybe: 
========================================= 
Call:
hybe = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + const + trend 

     hybe.l1        sm.l1        yg.l1       jyp.l1      hybe.l2        sm.l2 
 0.898826902 -0.129257139  0.240081729 -0.195873591  0.086817669  0.112162459 
       yg.l2       jyp.l2        const        trend 
-0.145841108  0.163410772  0.119069039  0.001963864 


Estimated coefficients for equation sm: 
======================================= 
Call:
sm = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + const + trend 

     hybe.l1        sm.l1        yg.l1       jyp.l1      hybe.l2        sm.l2 
-0.003282289  0.979354101 -0.124633554 -0.030561719  0.006619618 -0.001280822 
       yg.l2       jyp.l2        const        trend 
 0.099485625  0.041169059  0.424147339  0.001889801 


Estimated coefficients for equation yg: 
======================================= 
Call:
yg = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + const + trend 

      hybe.l1         sm.l1         yg.l1        jyp.l1       hybe.l2 
-0.0017546456 -0.0129013663  0.8872940815 -0.0132784925  0.0020911541 
        sm.l2         yg.l2        jyp.l2         const         trend 
 0.0157819564  0.1016893422  0.0123618307  0.2539521440  0.0001621699 


Estimated coefficients for equation jyp: 
======================================== 
Call:
jyp = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + const + trend 

     hybe.l1        sm.l1        yg.l1       jyp.l1      hybe.l2        sm.l2 
-0.003714104 -0.013862592 -0.042708139  0.845587797  0.003228421 -0.002809650 
       yg.l2       jyp.l2        const        trend 
 0.065350796  0.141050674 -0.223955478  0.002160854 </code></pre>
</div>
</div>
<p>The results from the CV test show that a model of p = 2 is the best at predicting HYBE stock prices in relation to SM, YG, and JYP. Since cross validation is a more accurate model selection technique, we will create both models where p=5,2. ### Model Creation:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_1, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_1
Chi-squared = 271.32, df = 160, p-value = 9.23e-08</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"jyp"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"yg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>var_model_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_2, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_2
Chi-squared = 154.19, df = 112, p-value = 0.005085</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"jyp"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"yg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-9-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the p-values, we can say that the model where p=2 has a much lower p-value, indicating that there is no serial correlation within the model. Thus, we will choose this model to forecast HYBE prices in relation to other KPOP agencies.</p>
</section>
<section id="forecasting" class="level3">
<h3 class="anchored" data-anchor-id="forecasting">Forecasting:</h3>
<div class="cell" data-cold-fold="true">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>fit.pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(var_model_1, <span class="at">n.ahead =</span> <span class="dv">365</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fanchart</span>(fit.pr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Thus, from our forecasting, we can see that SM, JYP, and YG all are similar in that the so a contextually upward trend of similar magnitude. Additionally, we see a downward trend for HYBE in the next year with a larger variance within the prediction.</p>
</section>
<section id="part-2" class="level1">
<h1>part 2:</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a subset of only Korean Record label stock data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> HYBE <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(UMGP, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WMG, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>hybe <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>HYBE_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>umgp <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>UMGP_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>wmg <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>WMG_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>df2_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hybe, umgp, wmg)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df2_ts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hybe"</span>, <span class="st">"umgp"</span>, <span class="st">"wmg"</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(df2_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From an initial visualization, it doesn’t appear that there is correlation between any of these stock prices, simply because the trends are so vastly different. HYBE, compared to the other stock prices, seems much more volatile, which makes it difficult to predict its forecasted prices. Thus, we’ll continue with the VAR model to work on forecasting.</p>
<section id="varselect-1" class="level3">
<h3 class="anchored" data-anchor-id="varselect-1">VARselect</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(df2_ts, <span class="at">lag.max=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
     5      5      1      5 

$criteria
                 1          2           3           4           5           6
AIC(n) -2.79861545 -2.8303916 -2.83985372 -2.86007366 -2.87984152 -2.87067434
HQ(n)  -2.77157093 -2.7871204 -2.78035578 -2.78434901 -2.78789016 -2.76249626
SC(n)  -2.72731952 -2.7163181 -2.68300269 -2.66044508 -2.63743538 -2.58549064
FPE(n)  0.06089433  0.0589898  0.05843435  0.05726482  0.05614415  0.05666151
                 7           8           9          10
AIC(n) -2.86626490 -2.86949081 -2.85918122 -2.85197621
HQ(n)  -2.74186011 -2.72885931 -2.70232301 -2.67889129
SC(n)  -2.53830365 -2.49875201 -2.44566486 -2.39568230
FPE(n)  0.05691233  0.05672957  0.05731815  0.05773348</code></pre>
</div>
</div>
<p>Here, we can see that VARselect() chose p=5,1, similar to the relation between KPOP agencies. Let’s continue by analyzing the residuals squared errors.</p>
</section>
<section id="initial-selection-1" class="level3">
<h3 class="anchored" data-anchor-id="initial-selection-1">Initial selection:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, umgp, wmg 
Deterministic variables: both 
Sample size: 1050 
Log Likelihood: -3020.018 
Roots of the characteristic polynomial:
0.9954 0.9811 0.9811
Call:
vars::VAR(y = df2_ts, p = 1, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + umgp.l1 + wmg.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.9874002  0.0038359 257.409  &lt; 2e-16 ***
umgp.l1 -0.4134390  0.2988988  -1.383  0.16690    
wmg.l1   0.1691336  0.0398344   4.246 2.37e-05 ***
const   -3.5345321  1.2007940  -2.943  0.00332 ** 
trend    0.0009025  0.0005039   1.791  0.07356 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.548 on 1045 degrees of freedom
Multiple R-Squared: 0.991,  Adjusted R-squared: 0.991 
F-statistic: 2.89e+04 on 4 and 1045 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation umgp: 
===================================== 
umgp = hybe.l1 + umgp.l1 + wmg.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  1.060e-04  7.167e-05   1.479    0.139    
umgp.l1  9.853e-01  5.584e-03 176.445   &lt;2e-16 ***
wmg.l1   1.426e-04  7.442e-04   0.192    0.848    
const   -1.131e-02  2.243e-02  -0.504    0.614    
trend   -5.273e-06  9.414e-06  -0.560    0.576    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.08497 on 1045 degrees of freedom
Multiple R-Squared: 0.9817, Adjusted R-squared: 0.9816 
F-statistic: 1.401e+04 on 4 and 1045 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation wmg: 
==================================== 
wmg = hybe.l1 + umgp.l1 + wmg.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1 -3.521e-04  5.531e-04  -0.636  0.52459    
umgp.l1  1.001e-01  4.310e-02   2.324  0.02034 *  
wmg.l1   9.848e-01  5.744e-03 171.454  &lt; 2e-16 ***
const    5.507e-01  1.731e-01   3.181  0.00151 ** 
trend   -9.905e-05  7.266e-05  -1.363  0.17310    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.6558 on 1045 degrees of freedom
Multiple R-Squared: 0.9852, Adjusted R-squared: 0.9851 
F-statistic: 1.734e+04 on 4 and 1045 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
          hybe      umgp      wmg
hybe 20.683699 -0.009843 0.023501
umgp -0.009843  0.007220 0.001463
wmg   0.023501  0.001463 0.430030

Correlation matrix of residuals:
         hybe     umgp     wmg
hybe  1.00000 -0.02547 0.00788
umgp -0.02547  1.00000 0.02625
wmg   0.00788  0.02625 1.00000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, umgp, wmg 
Deterministic variables: both 
Sample size: 1046 
Log Likelihood: -2889.659 
Roots of the characteristic polynomial:
0.995 0.9817 0.9817 0.6589 0.6499 0.6499 0.6072 0.6072 0.5731 0.5731 0.5694 0.531 0.531 0.4435 0.4147
Call:
vars::VAR(y = df2_ts, p = 5, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + umgp.l1 + wmg.l1 + hybe.l2 + umgp.l2 + wmg.l2 + hybe.l3 + umgp.l3 + wmg.l3 + hybe.l4 + umgp.l4 + wmg.l4 + hybe.l5 + umgp.l5 + wmg.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.8536278  0.0308478  27.672  &lt; 2e-16 ***
umgp.l1 -1.0652459  1.6099455  -0.662 0.508334    
wmg.l1   0.2683161  0.2049836   1.309 0.190839    
hybe.l2  0.1477791  0.0407233   3.629 0.000299 ***
umgp.l2  2.4380126  2.1402853   1.139 0.254924    
wmg.l2   0.0342823  0.2713718   0.126 0.899496    
hybe.l3  0.0827366  0.0409220   2.022 0.043454 *  
umgp.l3 -1.5539205  2.0986071  -0.740 0.459194    
wmg.l3   0.1894419  0.2721772   0.696 0.486571    
hybe.l4  0.0347094  0.0398020   0.872 0.383384    
umgp.l4  2.6506087  2.1383552   1.240 0.215423    
wmg.l4  -0.1359822  0.2717097  -0.500 0.616852    
hybe.l5 -0.1286473  0.0294432  -4.369 1.37e-05 ***
umgp.l5 -2.8808918  1.6099556  -1.789 0.073841 .  
wmg.l5  -0.2292495  0.2059511  -1.113 0.265914    
const   -2.3625235  1.1766427  -2.008 0.044920 *  
trend    0.0004436  0.0004824   0.920 0.357984    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.285 on 1029 degrees of freedom
Multiple R-Squared: 0.9922, Adjusted R-squared: 0.992 
F-statistic:  8136 on 16 and 1029 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation umgp: 
===================================== 
umgp = hybe.l1 + umgp.l1 + wmg.l1 + hybe.l2 + umgp.l2 + wmg.l2 + hybe.l3 + umgp.l3 + wmg.l3 + hybe.l4 + umgp.l4 + wmg.l4 + hybe.l5 + umgp.l5 + wmg.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1 -3.726e-04  5.956e-04  -0.625  0.53179    
umgp.l1  8.751e-01  3.109e-02  28.152  &lt; 2e-16 ***
wmg.l1   5.793e-03  3.958e-03   1.464  0.14358    
hybe.l2  2.137e-04  7.863e-04   0.272  0.78582    
umgp.l2  4.105e-04  4.133e-02   0.010  0.99208    
wmg.l2  -1.157e-02  5.240e-03  -2.209  0.02742 *  
hybe.l3  8.423e-05  7.901e-04   0.107  0.91513    
umgp.l3  2.658e-01  4.052e-02   6.560 8.52e-11 ***
wmg.l3   5.096e-03  5.255e-03   0.970  0.33239    
hybe.l4  9.731e-05  7.685e-04   0.127  0.89927    
umgp.l4 -7.039e-02  4.129e-02  -1.705  0.08854 .  
wmg.l4   2.943e-03  5.246e-03   0.561  0.57497    
hybe.l5  8.739e-05  5.685e-04   0.154  0.87785    
umgp.l5 -8.534e-02  3.109e-02  -2.745  0.00615 ** 
wmg.l5  -2.154e-03  3.977e-03  -0.542  0.58823    
const   -1.084e-02  2.272e-02  -0.477  0.63331    
trend   -5.483e-06  9.315e-06  -0.589  0.55625    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.08274 on 1029 degrees of freedom
Multiple R-Squared: 0.9829, Adjusted R-squared: 0.9826 
F-statistic:  3691 on 16 and 1029 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation wmg: 
==================================== 
wmg = hybe.l1 + umgp.l1 + wmg.l1 + hybe.l2 + umgp.l2 + wmg.l2 + hybe.l3 + umgp.l3 + wmg.l3 + hybe.l4 + umgp.l4 + wmg.l4 + hybe.l5 + umgp.l5 + wmg.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  3.423e-03  4.676e-03   0.732  0.46436    
umgp.l1 -1.020e-01  2.440e-01  -0.418  0.67612    
wmg.l1   8.640e-01  3.107e-02  27.806  &lt; 2e-16 ***
hybe.l2 -1.977e-03  6.173e-03  -0.320  0.74882    
umgp.l2  4.848e-01  3.244e-01   1.494  0.13540    
wmg.l2   1.159e-01  4.114e-02   2.817  0.00493 ** 
hybe.l3  4.238e-04  6.203e-03   0.068  0.94554    
umgp.l3 -3.255e-01  3.181e-01  -1.023  0.30643    
wmg.l3   9.549e-02  4.126e-02   2.315  0.02083 *  
hybe.l4 -6.184e-04  6.033e-03  -0.103  0.91838    
umgp.l4 -2.872e-01  3.241e-01  -0.886  0.37574    
wmg.l4  -1.480e-02  4.119e-02  -0.359  0.71950    
hybe.l5 -1.578e-03  4.463e-03  -0.354  0.72372    
umgp.l5  3.420e-01  2.440e-01   1.401  0.16139    
wmg.l5  -7.780e-02  3.122e-02  -2.492  0.01286 *  
const    6.116e-01  1.784e-01   3.429  0.00063 ***
trend   -1.121e-04  7.313e-05  -1.533  0.12555    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.6496 on 1029 degrees of freedom
Multiple R-Squared: 0.9856, Adjusted R-squared: 0.9854 
F-statistic:  4406 on 16 and 1029 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
           hybe      umgp        wmg
hybe 18.3621988 -0.011192 -0.0006314
umgp -0.0111920  0.006846  0.0021045
wmg  -0.0006314  0.002105  0.4219207

Correlation matrix of residuals:
           hybe     umgp        wmg
hybe  1.0000000 -0.03157 -0.0002268
umgp -0.0315674  1.00000  0.0391586
wmg  -0.0002268  0.03916  1.0000000</code></pre>
</div>
</div>
<p>From the residual squared errors and significance values, we can see that both models are very similar. The error on UMGP and WMG are very low, however the error for HYBE is larger at at approximately 4. Thus, we’ll continue model selection through cross validation.</p>
</section>
<section id="cross-validation-1" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-1">Cross Validation:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">=</span> <span class="dv">5</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>best_performance <span class="ot">&lt;-</span> <span class="cn">Inf</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>fold_s <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">nrow</span>(df2_ts)<span class="sc">/</span>folds)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>folds){</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">&lt;-</span> (fold<span class="dv">-1</span>)<span class="sc">*</span>fold_s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  end <span class="ot">&lt;-</span> fold<span class="sc">*</span>fold_s</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  train_model <span class="ot">&lt;-</span> df2_ts[<span class="sc">-</span>(start<span class="sc">:</span>end), ]</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  test_model <span class="ot">&lt;-</span> df2_ts[start<span class="sc">:</span>end, ]</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  sel <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(train_model, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"both"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  best_lag <span class="ot">&lt;-</span> sel<span class="sc">$</span>selection[<span class="dv">1</span>]</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(train_model, <span class="at">p=</span>best_lag, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">nrow</span>(test_model)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> h)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  pred_hybe <span class="ot">&lt;-</span> pred<span class="sc">$</span>fcst<span class="sc">$</span>hybe[,<span class="dv">1</span>]</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_hybe <span class="sc">-</span> test_model[, <span class="st">"hybe"</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(mse <span class="sc">&lt;</span> best_performance){</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> fit</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    best_performance <span class="ot">&lt;-</span> mse</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The best model is: "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The best model is: "</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
======================= 

Estimated coefficients for equation hybe: 
========================================= 
Call:
hybe = hybe.l1 + umgp.l1 + wmg.l1 + hybe.l2 + umgp.l2 + wmg.l2 + hybe.l3 + umgp.l3 + wmg.l3 + hybe.l4 + umgp.l4 + wmg.l4 + hybe.l5 + umgp.l5 + wmg.l5 + hybe.l6 + umgp.l6 + wmg.l6 + hybe.l7 + umgp.l7 + wmg.l7 + hybe.l8 + umgp.l8 + wmg.l8 + const + trend 

      hybe.l1       umgp.l1        wmg.l1       hybe.l2       umgp.l2 
 0.8757353675 -0.5532816086  0.3870418011  0.1403299563  4.5910405882 
       wmg.l2       hybe.l3       umgp.l3        wmg.l3       hybe.l4 
-0.8441527930  0.0350757965 -4.3266350264  0.3958843519  0.0166587539 
      umgp.l4        wmg.l4       hybe.l5       umgp.l5        wmg.l5 
 4.3390282814 -0.1523697268  0.0008273759 -3.3109233541 -0.1747831988 
      hybe.l6       umgp.l6        wmg.l6       hybe.l7       umgp.l7 
-0.1691034486 -1.9451291119  0.9313591689  0.0852656719  3.9147342098 
       wmg.l7       hybe.l8       umgp.l8        wmg.l8         const 
-0.5665090451  0.0021287351 -3.2067566290  0.1318396425 -1.2217738198 
        trend 
 0.0006281570 


Estimated coefficients for equation umgp: 
========================================= 
Call:
umgp = hybe.l1 + umgp.l1 + wmg.l1 + hybe.l2 + umgp.l2 + wmg.l2 + hybe.l3 + umgp.l3 + wmg.l3 + hybe.l4 + umgp.l4 + wmg.l4 + hybe.l5 + umgp.l5 + wmg.l5 + hybe.l6 + umgp.l6 + wmg.l6 + hybe.l7 + umgp.l7 + wmg.l7 + hybe.l8 + umgp.l8 + wmg.l8 + const + trend 

      hybe.l1       umgp.l1        wmg.l1       hybe.l2       umgp.l2 
-3.392028e-04  9.557157e-01  7.370151e-03  1.061674e-03 -8.060659e-02 
       wmg.l2       hybe.l3       umgp.l3        wmg.l3       hybe.l4 
-1.277957e-02 -6.255746e-04  2.753141e-01  6.371838e-03  1.307248e-04 
      umgp.l4        wmg.l4       hybe.l5       umgp.l5        wmg.l5 
-7.821239e-02 -9.238434e-04  2.612030e-04 -1.501987e-01 -3.912750e-04 
      hybe.l6       umgp.l6        wmg.l6       hybe.l7       umgp.l7 
-1.531754e-03  1.617081e-01 -1.042985e-03  2.553486e-03 -8.735351e-02 
       wmg.l7       hybe.l8       umgp.l8        wmg.l8         const 
-8.682740e-03 -1.434416e-03 -9.115995e-03  1.003801e-02 -1.173192e-03 
        trend 
-7.565872e-06 


Estimated coefficients for equation wmg: 
======================================== 
Call:
wmg = hybe.l1 + umgp.l1 + wmg.l1 + hybe.l2 + umgp.l2 + wmg.l2 + hybe.l3 + umgp.l3 + wmg.l3 + hybe.l4 + umgp.l4 + wmg.l4 + hybe.l5 + umgp.l5 + wmg.l5 + hybe.l6 + umgp.l6 + wmg.l6 + hybe.l7 + umgp.l7 + wmg.l7 + hybe.l8 + umgp.l8 + wmg.l8 + const + trend 

      hybe.l1       umgp.l1        wmg.l1       hybe.l2       umgp.l2 
 9.118657e-03 -3.762958e-02  9.150917e-01 -9.246550e-03  5.127581e-01 
       wmg.l2       hybe.l3       umgp.l3        wmg.l3       hybe.l4 
 3.452749e-02 -2.725464e-05 -3.853557e-01  6.970382e-02  6.300075e-07 
      umgp.l4        wmg.l4       hybe.l5       umgp.l5        wmg.l5 
-1.524228e-01  9.323498e-03  2.290240e-03  1.809426e-01 -5.698194e-02 
      hybe.l6       umgp.l6        wmg.l6       hybe.l7       umgp.l7 
-9.464415e-03  4.173369e-01 -6.757319e-03  2.260679e-02 -1.098781e+00 
       wmg.l7       hybe.l8       umgp.l8        wmg.l8         const 
 1.928490e-02 -1.605151e-02  6.649618e-01 -3.901367e-03  7.781349e-01 
        trend 
-1.467307e-04 </code></pre>
</div>
</div>
<p>CV seems to have chosen a different model where p=8. Thus, we’ll create models for p=1,5,8.</p>
</section>
<section id="model-creation" class="level3">
<h3 class="anchored" data-anchor-id="model-creation">Model Creation:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_1, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_1
Chi-squared = 264.14, df = 99, p-value &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"umgp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"wmg"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>var_model_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_2, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_2
Chi-squared = 88.378, df = 63, p-value = 0.01918</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"umgp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"wmg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>var_model_3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">8</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_3, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_3
Chi-squared = 42.802, df = 36, p-value = 0.2023</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"umgp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-8.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"wmg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-15-9.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the p-values and ACF plots of the residuals, the model where p=5 seems to be the best model for forecasting. the residuals are not correlated and the p-value is significant as it is 0.01918 &lt; 0.05.</p>
</section>
<section id="forecasting-1" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-1">Forecasting:</h3>
<div class="cell" data-cold-fold="true">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>fit.pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(var_model_1, <span class="at">n.ahead =</span> <span class="dv">365</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fanchart</span>(fit.pr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From this forecasting into the next year, we can see a strong negative trend for both HYBE and WMG, while UMGP’s stock price remains approximately constant. This prediction is similar to what we found from the previous model, such that HYBE will be experiencing a downward trend in prices for the upcoming year. This may be due to a number of reasons, however, most notably would be that their most successful artist, BTS, are continuing their hiatus as the members of the group complete their mandatory military service in South Korea.</p>
<p>Knowing this downward trend in the stock prices of the biggest performing KPOP music agency, we can start to see a downward shift in KPOP among investors globally. Thus, we may need to discuss the direction of cultural globalization in relation to South Korea.</p>
</section>
</section>
<section id="part-3" class="level1">
<h1>Part 3:</h1>
<p>Let’s see if the cultural globalization index in relation to tourism in South Korea will be trending downward in relation to our previous forecasting.</p>
<section id="gathering-the-data" class="level3">
<h3 class="anchored" data-anchor-id="gathering-the-data">Gathering the Data</h3>
<p>We’ll combine the globalization index data from KOF with the South Korean tourism data from Statistica.</p>
<p>As discussed previously, we will be modeling the cultural globalization index quantified by KOF within the United States in conjunction with tourism with South Korea throughout the 21st century. As we are focusing on KPOP’s influence within the United States, an integral part of globalization and cultural exchange is through tourism. Thus, looking at the relationship between tourism into South Korea and global culture in the United States will further help to understand this exchange in culture.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>global_ts <span class="ot">&lt;-</span><span class="fu">ts</span>(df3, <span class="at">start =</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(global_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cultural Globalization in USA and Tourism in South Korea"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the graphs above, we can see a similar positive trend between both the globalization index and tourists entering South Korea. However, tourism takes a sharp downward trend in 2020. This is, of course, due to the COVID-19 global pandemic that prevented all travel into South Korea from foreigners. Since this data point is an anomaly to determine cultural trends, will continue this model without 2020.</p>
</section>
<section id="using-auto.arima" class="level3">
<h3 class="anchored" data-anchor-id="using-auto.arima">Using Auto.Arima()</h3>
<p>Now, let’s move on with the ARIMAX/ARMAX model. First, we’ll create a model using auto.arima().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(global_ts[, <span class="st">"KOFCuGIdf"</span>], <span class="at">xreg =</span> global_ts[, <span class="st">"tourists"</span>])</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: global_ts[, "KOFCuGIdf"] 
Regression with ARIMA(2,0,0) errors 

Coefficients:
         ar1      ar2  intercept  xreg
      1.6838  -0.7370    87.7759     0
s.e.  0.1365   0.1434     0.4453     0

sigma^2 = 2.666:  log likelihood = -38.14
AIC=86.28   AICc=90.57   BIC=91.26

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE      MASE      ACF1
Training set 0.2527717 1.460494 1.089386 0.2644077 1.265622 0.9198188 0.1042156</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(2,0,0) errors
Q* = 7.4991, df = 3, p-value = 0.05758

Model df: 2.   Total lags used: 5</code></pre>
</div>
</div>
<p>Based on the summary statistics of the model created, auto.arima() created the model ARMA(2,0). Additionally, there is no cross correlation in the residuals and the p-value based in the Ljung-Box test is significant.</p>
</section>
<section id="manually-finding-the-model" class="level3">
<h3 class="anchored" data-anchor-id="manually-finding-the-model">Manually Finding the Model:</h3>
<p>We’ll move now to find the ARMAX model manually. Let’s start by taking creating a regression model of tourism on cultural globalization. Using that model, we’ll take the residuals and test multiple Arima models in order to find the one with the lowest AIC and BIC values. From there, after analyzing the residuals and significance of the variables, we’ll validate the model through cross validation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>df3<span class="sc">$</span>tourists <span class="ot">&lt;-</span><span class="fu">ts</span>(df3<span class="sc">$</span>tourists, <span class="at">start=</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>df3<span class="sc">$</span>KOFCuGIdf <span class="ot">&lt;-</span><span class="fu">ts</span>(df3<span class="sc">$</span>KOFCuGIdf, <span class="at">start=</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>fit.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(KOFCuGIdf <span class="sc">~</span> tourists, <span class="at">data =</span> df3)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = KOFCuGIdf ~ tourists, data = df3)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.2468 -4.0753  0.9324  3.8493  8.2528 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 7.783e+01  3.063e+00   25.41  1.5e-15 ***
tourists    1.202e-06  2.918e-07    4.12 0.000644 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.468 on 18 degrees of freedom
Multiple R-squared:  0.4853,    Adjusted R-squared:  0.4567 
F-statistic: 16.97 on 1 and 18 DF,  p-value: 0.0006436</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>res.fit<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit.reg), <span class="at">start=</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the residuals, we can see that there is no cross correlation between the residuals within the ACF plot. Thus, we can move on to manually simulating ARMA models, since we do not need to difference the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">25</span>),<span class="at">nrow=</span><span class="dv">25</span>) <span class="co"># roughly nrow = 5x2 (see below)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>)<span class="co"># p=0,1,2,3,4 : 5</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>)<span class="co"># q=0,1,2,3,4 :5</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(res.fit, <span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(output)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">127.2329</td>
<td style="text-align: right;">130.2201</td>
<td style="text-align: right;">128.7329</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">116.8798</td>
<td style="text-align: right;">120.8627</td>
<td style="text-align: right;">119.5464</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">111.9461</td>
<td style="text-align: right;">116.9248</td>
<td style="text-align: right;">116.2318</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">109.5787</td>
<td style="text-align: right;">115.5531</td>
<td style="text-align: right;">116.0402</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">111.3460</td>
<td style="text-align: right;">118.3162</td>
<td style="text-align: right;">120.6794</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">106.7209</td>
<td style="text-align: right;">110.7039</td>
<td style="text-align: right;">109.3876</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">108.4723</td>
<td style="text-align: right;">113.4510</td>
<td style="text-align: right;">112.7580</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108.4037</td>
<td style="text-align: right;">114.3781</td>
<td style="text-align: right;">114.8653</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">110.3598</td>
<td style="text-align: right;">117.3299</td>
<td style="text-align: right;">119.6931</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">112.3462</td>
<td style="text-align: right;">120.3121</td>
<td style="text-align: right;">125.4371</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">108.2759</td>
<td style="text-align: right;">113.2546</td>
<td style="text-align: right;">112.5616</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">105.2455</td>
<td style="text-align: right;">111.2199</td>
<td style="text-align: right;">111.7071</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104.8959</td>
<td style="text-align: right;">111.8660</td>
<td style="text-align: right;">114.2292</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">112.2294</td>
<td style="text-align: right;">120.1952</td>
<td style="text-align: right;">125.3203</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">114.0108</td>
<td style="text-align: right;">122.9724</td>
<td style="text-align: right;">132.0108</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">107.7495</td>
<td style="text-align: right;">113.7239</td>
<td style="text-align: right;">114.2110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">105.8867</td>
<td style="text-align: right;">112.8568</td>
<td style="text-align: right;">115.2200</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">112.1006</td>
<td style="text-align: right;">120.0664</td>
<td style="text-align: right;">125.1915</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">113.3105</td>
<td style="text-align: right;">122.2721</td>
<td style="text-align: right;">131.3105</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">115.3092</td>
<td style="text-align: right;">125.2666</td>
<td style="text-align: right;">139.7537</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">109.2205</td>
<td style="text-align: right;">116.1906</td>
<td style="text-align: right;">118.5538</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">111.1023</td>
<td style="text-align: right;">119.0682</td>
<td style="text-align: right;">124.1932</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">113.2815</td>
<td style="text-align: right;">122.2431</td>
<td style="text-align: right;">131.2815</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">111.4614</td>
<td style="text-align: right;">121.4187</td>
<td style="text-align: right;">135.9058</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">111.5921</td>
<td style="text-align: right;">122.5452</td>
<td style="text-align: right;">144.5921</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC     BIC     AICc
13 2 0 2 104.8959 111.866 114.2292</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 1 0 0 106.7209 110.7039 109.3876</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 1 0 0 106.7209 110.7039 109.3876</code></pre>
</div>
</div>
<p>From the manual process, we can see the models produced with the lowest AIC and BIC values are ARMA(2,2) and ARMA(1,0). Thus, we’ll take a look at the residuals of the following models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "initial  value 1.585318 "                                                              
 [2] "iter   2 value 1.000819"                                                               
 [3] "iter   3 value 0.979873"                                                               
 [4] "iter   4 value 0.971786"                                                               
 [5] "iter   5 value 0.970922"                                                               
 [6] "iter   6 value 0.970615"                                                               
 [7] "iter   7 value 0.970607"                                                               
 [8] "iter   8 value 0.970607"                                                               
 [9] "iter   8 value 0.970607"                                                               
[10] "iter   8 value 0.970607"                                                               
[11] "final  value 0.970607 "                                                                
[12] "converged"                                                                             
[13] "initial  value 1.116539 "                                                              
[14] "iter   2 value 1.064095"                                                               
[15] "iter   3 value 1.062560"                                                               
[16] "iter   4 value 1.061681"                                                               
[17] "iter   5 value 1.061650"                                                               
[18] "iter   6 value 1.061650"                                                               
[19] "iter   6 value 1.061650"                                                               
[20] "final  value 1.061650 "                                                                
[21] "converged"                                                                             
[22] "$fit"                                                                                  
[23] ""                                                                                      
[24] "Call:"                                                                                 
[25] "arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), "
[26] "    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, "       
[27] "    optim.control = list(trace = trc, REPORT = 1, reltol = tol))"                      
[28] ""                                                                                      
[29] "Coefficients:"                                                                         
[30] "         ar1    xmean"                                                                 
[31] "      0.8652  -2.5386"                                                                 
[32] "s.e.  0.1038   3.8694"                                                                 
[33] ""                                                                                      
[34] "sigma^2 estimated as 7.801:  log likelihood = -49.61,  aic = 105.22"                   
[35] ""                                                                                      
[36] "$degrees_of_freedom"                                                                   
[37] "[1] 18"                                                                                
[38] ""                                                                                      
[39] "$ttable"                                                                               
[40] "      Estimate     SE t.value p.value"                                                 
[41] "ar1     0.8652 0.1038  8.3328  0.0000"                                                 
[42] "xmean  -2.5386 3.8694 -0.6561  0.5201"                                                 
[43] ""                                                                                      
[44] "$AIC"                                                                                  
[45] "[1] 5.261176"                                                                          
[46] ""                                                                                      
[47] "$AICc"                                                                                 
[48] "[1] 5.29647"                                                                           
[49] ""                                                                                      
[50] "$BIC"                                                                                  
[51] "[1] 5.410536"                                                                          
[52] ""                                                                                      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "initial  value 1.553778 "                                                              
 [2] "iter   2 value 1.430949"                                                               
 [3] "iter   3 value 1.042676"                                                               
 [4] "iter   4 value 0.993029"                                                               
 [5] "iter   5 value 0.974081"                                                               
 [6] "iter   6 value 0.956070"                                                               
 [7] "iter   7 value 0.949449"                                                               
 [8] "iter   8 value 0.944797"                                                               
 [9] "iter   9 value 0.942595"                                                               
[10] "iter  10 value 0.941319"                                                               
[11] "iter  11 value 0.940887"                                                               
[12] "iter  12 value 0.940866"                                                               
[13] "iter  13 value 0.940866"                                                               
[14] "iter  14 value 0.940865"                                                               
[15] "iter  15 value 0.940862"                                                               
[16] "iter  16 value 0.940853"                                                               
[17] "iter  17 value 0.940845"                                                               
[18] "iter  18 value 0.940830"                                                               
[19] "iter  19 value 0.940820"                                                               
[20] "iter  20 value 0.940818"                                                               
[21] "iter  21 value 0.940816"                                                               
[22] "iter  22 value 0.940816"                                                               
[23] "iter  22 value 0.940816"                                                               
[24] "iter  22 value 0.940816"                                                               
[25] "final  value 0.940816 "                                                                
[26] "converged"                                                                             
[27] "initial  value 1.014365 "                                                              
[28] "iter   2 value 1.000713"                                                               
[29] "iter   3 value 0.998434"                                                               
[30] "iter   4 value 0.997970"                                                               
[31] "iter   5 value 0.997732"                                                               
[32] "iter   6 value 0.997580"                                                               
[33] "iter   7 value 0.997379"                                                               
[34] "iter   8 value 0.997048"                                                               
[35] "iter   9 value 0.996543"                                                               
[36] "iter  10 value 0.995733"                                                               
[37] "iter  11 value 0.991400"                                                               
[38] "iter  12 value 0.985956"                                                               
[39] "iter  13 value 0.981444"                                                               
[40] "iter  14 value 0.974812"                                                               
[41] "iter  15 value 0.971043"                                                               
[42] "iter  16 value 0.960387"                                                               
[43] "iter  17 value 0.955391"                                                               
[44] "iter  18 value 0.944255"                                                               
[45] "iter  19 value 0.918264"                                                               
[46] "iter  20 value 0.911566"                                                               
[47] "iter  21 value 0.908276"                                                               
[48] "iter  22 value 0.904759"                                                               
[49] "iter  23 value 0.902341"                                                               
[50] "iter  24 value 0.902240"                                                               
[51] "iter  25 value 0.902160"                                                               
[52] "iter  26 value 0.901582"                                                               
[53] "iter  27 value 0.900613"                                                               
[54] "iter  28 value 0.900164"                                                               
[55] "iter  29 value 0.900127"                                                               
[56] "iter  30 value 0.900121"                                                               
[57] "iter  31 value 0.900121"                                                               
[58] "iter  32 value 0.900121"                                                               
[59] "iter  32 value 0.900121"                                                               
[60] "iter  32 value 0.900121"                                                               
[61] "final  value 0.900121 "                                                                
[62] "converged"                                                                             
[63] "$fit"                                                                                  
[64] ""                                                                                      
[65] "Call:"                                                                                 
[66] "arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), "
[67] "    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, "       
[68] "    optim.control = list(trace = trc, REPORT = 1, reltol = tol))"                      
[69] ""                                                                                      
[70] "Coefficients:"                                                                         
[71] "         ar1      ar2      ma1     ma2   xmean"                                        
[72] "      1.8206  -0.9472  -1.2918  0.2918  0.4865"                                        
[73] "s.e.  0.0631   0.0603   0.3380  0.2889  0.8530"                                        
[74] ""                                                                                      
[75] "sigma^2 estimated as 4.709:  log likelihood = -46.38,  aic = 104.76"                   
[76] ""                                                                                      
[77] "$degrees_of_freedom"                                                                   
[78] "[1] 15"                                                                                
[79] ""                                                                                      
[80] "$ttable"                                                                               
[81] "      Estimate     SE  t.value p.value"                                                
[82] "ar1     1.8206 0.0631  28.8298  0.0000"                                                
[83] "ar2    -0.9472 0.0603 -15.7180  0.0000"                                                
[84] "ma1    -1.2918 0.3380  -3.8223  0.0017"                                                
[85] "ma2     0.2918 0.2889   1.0100  0.3285"                                                
[86] "xmean   0.4865 0.8530   0.5703  0.5769"                                                
[87] ""                                                                                      
[88] "$AIC"                                                                                  
[89] "[1] 5.238119"                                                                          
[90] ""                                                                                      
[91] "$AICc"                                                                                 
[92] "[1] 5.452405"                                                                          
[93] ""                                                                                      
[94] "$BIC"                                                                                  
[95] "[1] 5.536838"                                                                          
[96] ""                                                                                      </code></pre>
</div>
</div>
<p>From the following residual plots, we can say that model ARMA(1,0) is the better of the two models due to the lack of cross correlation between the residuals. However, we’ll move onto cross validation in order to determine which of the ARMAX models are the best for forecasting.</p>
</section>
<section id="cv" class="level3">
<h3 class="anchored" data-anchor-id="cv">CV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(res.fit)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># Assuming 5 is the maximum number of observations for testing</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">15</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">15</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">15</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(res.fit)[<span class="dv">1</span>] <span class="sc">+</span> (k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) {</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the training set</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  train_end <span class="ot">&lt;-</span> st <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit, <span class="at">end =</span> train_end)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the testing set</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  test_start <span class="ot">&lt;-</span> train_end <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  test_end <span class="ot">&lt;-</span> <span class="fu">min</span>(st <span class="sc">+</span> i, <span class="fu">tsp</span>(res.fit)[<span class="dv">2</span>])</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit, <span class="at">start =</span> test_start, <span class="at">end =</span> test_end)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>  rmse1[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  rmse2[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>  rmse3[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast3<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(z[[2L]] * object$sigma2): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in forecast.forecast_ARIMA(fit3, h = 4): Upper prediction intervals are
not finite.

Warning in forecast.forecast_ARIMA(fit3, h = 4): Upper prediction intervals are
not finite.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, rmse2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"horizon"</span>, <span class="at">ylab =</span> <span class="st">"RMSE"</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, rmse1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, rmse3, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"fit2"</span>, <span class="st">"fit1"</span>, <span class="st">"fit3"</span>), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the cross validation function, we can see that model ARMA(1, 0) is the best model given that the RMSE values are the lowest across the cross folds. Thus, we’ll choose to forecast Korean tourism on cultural globalization in the US via model 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(global_ts[, <span class="st">"KOFCuGIdf"</span>], <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">xreg =</span> global_ts[, <span class="st">"tourists"</span>])</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: global_ts[, "KOFCuGIdf"] 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1  intercept  xreg
      0.9684    84.7153     0
s.e.  0.0398     1.3007     0

sigma^2 = 5.577:  log likelihood = -45.33
AIC=98.66   AICc=101.32   BIC=102.64

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE    MASE     ACF1
Training set 0.8955075 2.177229 1.295393 0.9914592 1.500592 1.09376 0.462599</code></pre>
</div>
</div>
</section>
<section id="forecasting-2" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-2">Forecasting:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>tourists_fit <span class="ot">&lt;-</span><span class="fu">auto.arima</span>(global_ts[, <span class="st">"tourists"</span>]) </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tourists_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: global_ts[, "tourists"] 
ARIMA(1,1,0) with drift 

Coefficients:
          ar1     drift
      -0.5710  627170.2
s.e.   0.1837  185981.8

sigma^2 = 1.743e+12:  log likelihood = -293.87
AIC=593.75   AICc=595.35   BIC=596.58

Training set error measures:
                    ME    RMSE      MAE      MPE     MAPE      MASE       ACF1
Training set -15386.25 1217172 961194.1 -2.96541 9.812744 0.7784607 -0.1121698</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>ft<span class="ot">&lt;-</span><span class="fu">forecast</span>(tourists_fit)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg=</span>ft<span class="sc">$</span>mean)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Globalization"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that in the next 10 years, globalization within the US with regards to Korea’s tourism of foreigners will see a slight decrease. As we’ve observed in out previous VAR models, this may be due to an incoming disinterest in KPOP as famous groups such as BTS step away from music in the near future and new groups unable to make a significant impact on the Western music industry as BTS has done.</p>
</section>
</section>
<section id="sarima" class="level1">
<h1>SARIMA:</h1>
<p>In order to understand globalization within the USA through the lens on South Korea, we will need to also look at the tourism coming into SK from abroad. An example of this is using monthly air travel passeneger data into Incheon Airport, South Korea’s largest international airport. Specifically, we’ll be focusing on international flights coming into South Korea as they best represent foreign interest of the nation.</p>
<section id="seasonal-anlysis" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-anlysis">Seasonal Anlysis</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>sk_passengers <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">'sk_passenger_arrivals.xlsx'</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>sk_passengers <span class="ot">&lt;-</span> sk_passengers <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(date, year, month, <span class="at">sep =</span> <span class="st">'-'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(date, <span class="st">'01'</span>, <span class="at">sep =</span> <span class="st">'-'</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(date) <span class="sc">&lt;</span> <span class="dv">2020</span>) <span class="co">#In order to avoid the anomaly of the 2020 pandemic</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>air_travel_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(sk_passengers<span class="sc">$</span>Passengers, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2010</span>, <span class="dv">10</span>), </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(air_travel_ts)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Air passenger arrivals to Incheon Airport (SK)"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the plot above, we can see that there is a seasonal pattern of passengers coming into the country yearly. Please note that to avoid anomalies in forecasting, we’ll not be training on 2020 data due to the restrictions on travel from the COVID-19 global pandemic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(air_travel_ts,<span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gglagplot</span>(air_travel_ts, <span class="at">do.lines=</span><span class="cn">FALSE</span>, <span class="at">set.lags =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">36</span>, <span class="dv">48</span>))<span class="sc">+</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Air passenger arrivals to Incheon Airport (SK)"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>dec2 <span class="ot">&lt;-</span> <span class="fu">decompose</span>(air_travel_ts,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">"additive"</span>, <span class="st">"multiplicative"</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-30-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Through these graphs, we can see a string seasonal correlation. However, since the data is mutliplicative in nature, we may need to take the log of the data prior to differencing.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(air_travel_ts) <span class="sc">%&gt;%</span> <span class="fu">diff</span>() <span class="sc">%&gt;%</span> <span class="fu">ggtsdisplay</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(air_travel_ts) <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">ggtsdisplay</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(air_travel_ts) <span class="sc">%&gt;%</span> <span class="fu">diff</span>() <span class="sc">%&gt;%</span> <span class="fu">diff</span>(<span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">ggtsdisplay</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the ACF and PACF plots, we can see that the data is the most stationary when the original data is log transformed, first differenced, and seasonally differenced by month. From these plots, we can say that q = 2, p = 2,4, d = 1, Q = 1, and P = 1.</p>
<p>In order to find the best model, we’ll run through mutliple models and find the ones with the lowest AIC and BIC score.</p>
</section>
<section id="determining-the-model" class="level3">
<h3 class="anchored" data-anchor-id="determining-the-model">Determining the Model</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write a function</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">35</span>),<span class="at">nrow=</span><span class="dv">35</span>)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>)</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>))</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">5</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">3</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">3</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">3</span>,<span class="at">data=</span>air_travel_ts)</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">Q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2574.346</td>
<td style="text-align: right;">2576.931</td>
<td style="text-align: right;">2574.387</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2546.796</td>
<td style="text-align: right;">2551.966</td>
<td style="text-align: right;">2546.922</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2548.444</td>
<td style="text-align: right;">2556.199</td>
<td style="text-align: right;">2548.700</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2556.745</td>
<td style="text-align: right;">2561.915</td>
<td style="text-align: right;">2556.871</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2548.420</td>
<td style="text-align: right;">2556.174</td>
<td style="text-align: right;">2548.675</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2550.394</td>
<td style="text-align: right;">2560.734</td>
<td style="text-align: right;">2550.824</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2552.772</td>
<td style="text-align: right;">2560.527</td>
<td style="text-align: right;">2553.028</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2550.382</td>
<td style="text-align: right;">2560.722</td>
<td style="text-align: right;">2550.812</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2574.807</td>
<td style="text-align: right;">2579.977</td>
<td style="text-align: right;">2574.933</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2543.326</td>
<td style="text-align: right;">2551.081</td>
<td style="text-align: right;">2543.581</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2545.179</td>
<td style="text-align: right;">2555.519</td>
<td style="text-align: right;">2545.609</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2555.892</td>
<td style="text-align: right;">2563.646</td>
<td style="text-align: right;">2556.147</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2545.173</td>
<td style="text-align: right;">2555.513</td>
<td style="text-align: right;">2545.603</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2549.534</td>
<td style="text-align: right;">2559.874</td>
<td style="text-align: right;">2549.964</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2562.654</td>
<td style="text-align: right;">2570.409</td>
<td style="text-align: right;">2562.910</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2533.345</td>
<td style="text-align: right;">2543.685</td>
<td style="text-align: right;">2533.775</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2538.189</td>
<td style="text-align: right;">2548.528</td>
<td style="text-align: right;">2538.619</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2575.603</td>
<td style="text-align: right;">2580.773</td>
<td style="text-align: right;">2575.729</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2546.295</td>
<td style="text-align: right;">2554.050</td>
<td style="text-align: right;">2546.551</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2547.917</td>
<td style="text-align: right;">2558.257</td>
<td style="text-align: right;">2548.347</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2557.701</td>
<td style="text-align: right;">2565.456</td>
<td style="text-align: right;">2557.956</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2547.901</td>
<td style="text-align: right;">2558.241</td>
<td style="text-align: right;">2548.332</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2552.662</td>
<td style="text-align: right;">2563.002</td>
<td style="text-align: right;">2553.092</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2562.140</td>
<td style="text-align: right;">2569.895</td>
<td style="text-align: right;">2562.395</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2535.527</td>
<td style="text-align: right;">2545.867</td>
<td style="text-align: right;">2535.957</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2544.476</td>
<td style="text-align: right;">2554.816</td>
<td style="text-align: right;">2544.907</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2562.137</td>
<td style="text-align: right;">2572.477</td>
<td style="text-align: right;">2562.567</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2571.112</td>
<td style="text-align: right;">2578.867</td>
<td style="text-align: right;">2571.368</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2541.018</td>
<td style="text-align: right;">2551.358</td>
<td style="text-align: right;">2541.448</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2549.599</td>
<td style="text-align: right;">2559.939</td>
<td style="text-align: right;">2550.029</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2562.815</td>
<td style="text-align: right;">2573.155</td>
<td style="text-align: right;">2563.245</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2572.829</td>
<td style="text-align: right;">2583.169</td>
<td style="text-align: right;">2573.260</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
16 0 1 2 0 1 1 2533.345 2543.685 2533.775</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
16 0 1 2 0 1 1 2533.345 2543.685 2533.775</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC     AICc
16 0 1 2 0 1 1 2533.345 2543.685 2533.775</code></pre>
</div>
</div>
<p>Based on the AIC, BIC, and AICc values, we’ll go forward with the model ARIMA(0,1,2)x(0,1,1)[12]. Let’s analyze this model for it’s residuals and siginificant values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(air_travel_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">28</span><span class="sc">:</span><span class="dv">60</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
    include.mean = !no.constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
        REPORT = 1, reltol = tol))

Coefficients:
          ma1      ma2     sma1
      -0.2648  -0.4423  -0.6406
s.e.   0.1007   0.1129   0.1102

sigma^2 estimated as 8.456e+09:  log likelihood = -1262.67,  aic = 2533.34

$degrees_of_freedom
[1] 95

$ttable
     Estimate     SE t.value p.value
ma1   -0.2648 0.1007 -2.6304   1e-02
ma2   -0.4423 0.1129 -3.9182   2e-04
sma1  -0.6406 0.1102 -5.8147   0e+00

$AIC
[1] 25.85046

$AICc
[1] 25.85306

$BIC
[1] 25.95596

NA
NA
NA
NA</code></pre>
</div>
</div>
<p>This model seems to be a goof fit for a number of reasons. Primarily, the ACF plot shows almost no correlation, indicating that the model has harnessed everything that left is white noise. This indicates a good model fit. Additionally, the Ljung-Box statistic shows almost no autocorrelation within the model. Lastly, all coefficients within the table are significant.</p>
</section>
<section id="fitting-the-model-and-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model-and-forecasting">Fitting the Model and Forecasting</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(air_travel_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: air_travel_ts 
ARIMA(0,1,2)(0,1,1)[12] 

Coefficients:
          ma1      ma2     sma1
      -0.2648  -0.4423  -0.6406
s.e.   0.1007   0.1129   0.1102

sigma^2 = 8.723e+09:  log likelihood = -1262.67
AIC=2533.34   AICc=2533.77   BIC=2543.68

Training set error measures:
                  ME     RMSE     MAE       MPE     MAPE      MASE         ACF1
Training set 5517.28 86406.29 53391.3 0.1750992 2.484263 0.2762785 -0.003659363</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima.for</span>(air_travel_ts, <span class="dv">60</span>, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$pred
         Jan     Feb     Mar     Apr     May     Jun     Jul     Aug     Sep
2020 3207700 3088739 3137521 3008503 3023479 3065866 3158244 3455060 2971110
2021 3374324 3265209 3313992 3184974 3199950 3242337 3334714 3631530 3147581
2022 3550794 3441680 3490462 3361444 3376420 3418807 3511185 3808001 3324051
2023 3727265 3618150 3666933 3537915 3552891 3595278 3687655 3984471 3500522
2024 3903735 3794621 3843403 3714385 3729362 3771748 3864126 4160942 3676993
         Oct     Nov     Dec
2020 3198943 2994382 3202800
2021 3375414 3170853 3379270
2022 3551884 3347324 3555741
2023 3728355 3523794 3732212
2024 3904825 3700265 3908682

$se
           Jan       Feb       Mar       Apr       May       Jun       Jul
2020  91967.55 114150.96 117287.13 120341.60 123320.43 126228.99 129072.02
2021 154564.85 162841.24 166909.38 170880.70 174761.80 178558.55 182276.24
2022 211638.14 220236.97 225053.12 229768.35 234388.73 238919.78 243366.49
2023 276140.40 285028.51 290476.20 295823.59 301076.02 306238.37 311315.13
2024 347172.02 356339.34 362340.94 368244.73 374055.36 379777.09 385413.89
           Aug       Sep       Oct       Nov       Dec
2020 131853.76 134579.14 137250.48 139869.37 142440.11
2021 185919.60 189494.86 193004.62 196448.48 199833.00
2022 247733.39 252026.94 256249.62 260399.76 264484.79
2023 316310.42 321230.51 326077.61 330849.20 335552.95
2024 390969.43 396449.67 401856.51 407186.86 412448.32</code></pre>
</div>
</div>
<p>Our forecast shows a positive upwards trend in international passenger arrivals into Incheon Airport, South Korea. Please note, this forecast shows five years into the future if the COVID-19 pandemic didn’t cause any anomalies within air travel. However, even knowing that the actual data isn’t the same, we can approximate that the travel industry would recover in a similar pattern, with a positive trend of people coming into Korea. Thus, this furthers the narrative of globalization, and specifically, Korean culture reaching outside its country’s borders into the West.</p>
</section>
</section>
<section id="homework-5" class="level1">
<h1>Homework 5:</h1>
<div class="cell">
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5600</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Doing an 80/20 split</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(df)), <span class="at">size =</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(df)) </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> df[train_indices, ] </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> df[<span class="sc">-</span>train_indices, ]</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">#First, fitting the model: </span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(HYBE_Price <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking residuals</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = HYBE_Price ~ ., data = train)

Residuals:
   Min     1Q Median     3Q    Max 
-87.63 -24.10   0.01  20.72  74.25 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.108e+03  1.769e+02  11.916   &lt;2e-16 ***
Date        -1.133e-01  9.432e-03 -12.015   &lt;2e-16 ***
SM_Price     1.475e+00  1.332e-01  11.073   &lt;2e-16 ***
YG_Price     5.063e+00  2.302e-01  21.990   &lt;2e-16 ***
JYP_Price   -1.314e+00  1.327e-01  -9.906   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 29 on 836 degrees of freedom
Multiple R-squared:  0.6317,    Adjusted R-squared:   0.63 
F-statistic: 358.5 on 4 and 836 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Since all the variables are significant, we’ll continue with this model to find its residuals.</p>
<div class="cell">
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>lm_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">cor</span>(test<span class="sc">$</span>HYBE_Price, lm_predictions)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test<span class="sc">$</span>HYBE_Price <span class="sc">-</span> lm_predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"R-squared:"</span>, r_squared))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R-squared: 0.58667065622527"</code></pre>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE:"</span>, rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE: 31.5268851064457"</code></pre>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>lm.residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(lm.residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(lm.residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(lm.residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  lm.residuals
Dickey-Fuller = -8.9644, Lag order = 9, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>We can see that the residuals are stationary in accordance to the Dickey-Fuller test. Additionally, both the ACF and the PACF plots show that the residuals are not auto correlated since the plot is approximately stationary. Thus, we can proceed with these residuals.</p>
<p>Next, using these residuals, we’ll first find the best ARMA/AR/ARIMA model. We’ll do this is two ways, first using auto.arima and then manually by running through multiple models.</p>
<section id="using-auto.arima-1" class="level3">
<h3 class="anchored" data-anchor-id="using-auto.arima-1">Using auto.arima</h3>
<div class="cell">
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>arima_model <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(lm.residuals)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arima_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lm.residuals 
ARIMA(0,0,0) with zero mean 

sigma^2 = 836:  log likelihood = -4022.7
AIC=8047.39   AICc=8047.4   BIC=8052.13

Training set error measures:
                       ME     RMSE      MAE MPE MAPE      MASE       ACF1
Training set 1.360155e-15 28.91303 23.92612 100  100 0.6951107 -0.0701053</code></pre>
</div>
</div>
<p>Auto arima provided the model where p,q,d = 0. This model would not correctly predict, therefore we turn to the manual approach for better output.</p>
</section>
<section id="manual-ararmaarima-model" class="level3">
<h3 class="anchored" data-anchor-id="manual-ararmaarima-model">Manual AR/ARMA/ARIMA Model</h3>
<div class="cell">
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">25</span>),<span class="at">nrow=</span><span class="dv">25</span>) </span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># p=0, 1,2,3, 4</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># q=0, 1,2,3,4</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">10</span>) <span class="co">#usual threshold</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>      model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(lm.residuals,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>      ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>      i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8049.256</td>
<td style="text-align: right;">8063.459</td>
<td style="text-align: right;">8049.284</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8047.069</td>
<td style="text-align: right;">8066.007</td>
<td style="text-align: right;">8047.116</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8048.019</td>
<td style="text-align: right;">8071.692</td>
<td style="text-align: right;">8048.091</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8049.359</td>
<td style="text-align: right;">8077.767</td>
<td style="text-align: right;">8049.460</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8050.912</td>
<td style="text-align: right;">8084.054</td>
<td style="text-align: right;">8051.046</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8046.786</td>
<td style="text-align: right;">8065.725</td>
<td style="text-align: right;">8046.834</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8047.856</td>
<td style="text-align: right;">8071.529</td>
<td style="text-align: right;">8047.928</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8049.746</td>
<td style="text-align: right;">8078.154</td>
<td style="text-align: right;">8049.847</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8050.935</td>
<td style="text-align: right;">8084.078</td>
<td style="text-align: right;">8051.070</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8052.780</td>
<td style="text-align: right;">8090.657</td>
<td style="text-align: right;">8052.953</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8047.880</td>
<td style="text-align: right;">8071.553</td>
<td style="text-align: right;">8047.952</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8049.757</td>
<td style="text-align: right;">8078.164</td>
<td style="text-align: right;">8049.858</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8051.781</td>
<td style="text-align: right;">8084.923</td>
<td style="text-align: right;">8051.915</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8050.634</td>
<td style="text-align: right;">8088.511</td>
<td style="text-align: right;">8050.807</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8054.804</td>
<td style="text-align: right;">8097.415</td>
<td style="text-align: right;">8055.020</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8049.542</td>
<td style="text-align: right;">8077.949</td>
<td style="text-align: right;">8049.642</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8051.002</td>
<td style="text-align: right;">8084.144</td>
<td style="text-align: right;">8051.136</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8050.141</td>
<td style="text-align: right;">8088.017</td>
<td style="text-align: right;">8050.314</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8055.183</td>
<td style="text-align: right;">8097.794</td>
<td style="text-align: right;">8055.400</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8054.533</td>
<td style="text-align: right;">8101.879</td>
<td style="text-align: right;">8054.798</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8050.818</td>
<td style="text-align: right;">8083.960</td>
<td style="text-align: right;">8050.953</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8052.676</td>
<td style="text-align: right;">8090.552</td>
<td style="text-align: right;">8052.849</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8053.909</td>
<td style="text-align: right;">8096.520</td>
<td style="text-align: right;">8054.125</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8055.875</td>
<td style="text-align: right;">8103.221</td>
<td style="text-align: right;">8056.140</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8046.913</td>
<td style="text-align: right;">8098.993</td>
<td style="text-align: right;">8047.231</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Best model: </span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 1 0 0 8046.786 8065.725 8046.834</code></pre>
</div>
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 0 0 0 8049.256 8063.459 8049.284</code></pre>
</div>
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 1 0 0 8046.786 8065.725 8046.834</code></pre>
</div>
</div>
<p>Thus, from the manually approach, the model with the lowest AIC value is AR(1). Thus, we’ll use this model within our approach to find the best ARCH/GARCH model.</p>
</section>
<section id="archgarch" class="level3">
<h3 class="anchored" data-anchor-id="archgarch">ARCH/GARCH</h3>
<p>Since the original data doesn’t show time-varying volatility within stock prices, we’ll go forward without testing the GARCH model. Thus, the two models we’ll look at is AR + ARCH and just ARCH in order to find the best one at predicting HYBE prices given its volatility.</p>
<div class="cell">
<details>
<summary>ARCH selection</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>best_ar_model <span class="ot">&lt;-</span> <span class="fu">Arima</span>(lm.residuals,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>ar.res <span class="ot">&lt;-</span> best_ar_model<span class="sc">$</span>residuals</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ar.res<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>ARCH selection</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ar.res<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>ARCH selection</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>arch_model <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="do">## set counter</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    arch_model[[cc]] <span class="ot">&lt;-</span> <span class="fu">garch</span>(ar.res,<span class="at">order=</span><span class="fu">c</span>(q,p),<span class="at">trace=</span>F)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    cc <span class="ot">&lt;-</span> cc <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="do">## get AIC values for model evaluation</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>ARCH_AIC <span class="ot">&lt;-</span> <span class="fu">sapply</span>(arch_model, AIC) <span class="do">## model with lowest AIC is the best</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>arch_model[[<span class="fu">which</span>(ARCH_AIC <span class="sc">==</span> <span class="fu">min</span>(ARCH_AIC))]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
garch(x = ar.res, order = c(q, p), trace = F)

Coefficient(s):
       a0         a1         b1         b2         b3         b4  
6.246e+02  9.202e-12  6.121e-02  6.027e-02  6.121e-02  6.023e-02  </code></pre>
</div>
</div>
<p>From the manually calculation, we can see that the best ARCH model is ARCH(1,4). The next step now is to check which whether the AR+ARCH model or the ARCH model itself is the best.</p>
<div class="cell">
<details>
<summary>Model selection</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">garchFit</span>(<span class="sc">~</span><span class="fu">garch</span>(<span class="dv">1</span>,<span class="dv">4</span>), ar.res, <span class="at">trace =</span> F)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Title:
 GARCH Modelling 

Call:
 garchFit(formula = ~garch(1, 4), data = ar.res, trace = F) 

Mean and Variance Equation:
 data ~ garch(1, 4)
&lt;environment: 0x7fce17201158&gt;
 [data = ar.res]

Conditional Distribution:
 norm 

Coefficient(s):
         mu        omega       alpha1        beta1        beta2        beta3  
-0.00134274  21.05589755   0.00000001   0.97494048   0.00000001   0.00000001  
      beta4  
 0.00000001  

Std. Errors:
 based on Hessian 

Error Analysis:
         Estimate  Std. Error  t value Pr(&gt;|t|)
mu     -1.343e-03   9.945e-01   -0.001    0.999
omega   2.106e+01   1.290e+01    1.632    0.103
alpha1  1.000e-08         NaN      NaN      NaN
beta1   9.749e-01   1.978e+01    0.049    0.961
beta2   1.000e-08   1.715e+01    0.000    1.000
beta3   1.000e-08         NaN      NaN      NaN
beta4   1.000e-08         NaN      NaN      NaN

Log Likelihood:
 -4020.602    normalized:  -4.78074 

Description:
 Wed Nov 22 21:53:37 2023 by user:  


Standardised Residuals Tests:
                                 Statistic      p-Value
 Jarque-Bera Test   R    Chi^2  18.0638061 1.195348e-04
 Shapiro-Wilk Test  R    W       0.9847035 1.076037e-07
 Ljung-Box Test     R    Q(10)   5.0485163 8.879136e-01
 Ljung-Box Test     R    Q(15)  23.2427741 7.911959e-02
 Ljung-Box Test     R    Q(20)  27.8650892 1.126317e-01
 Ljung-Box Test     R^2  Q(10)   7.4176133 6.855185e-01
 Ljung-Box Test     R^2  Q(15)   8.7640540 8.895276e-01
 Ljung-Box Test     R^2  Q(20)  18.6867078 5.422662e-01
 LM Arch Test       R    TR^2    7.5249668 8.210648e-01

Information Criterion Statistics:
     AIC      BIC      SIC     HQIC 
9.578127 9.617535 9.577990 9.593230 </code></pre>
</div>
<details>
<summary>Model selection</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">garchFit</span>(<span class="sc">~</span><span class="fu">arma</span>(<span class="dv">1</span>, <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">garch</span>(<span class="dv">1</span>, <span class="dv">4</span>), ar.res, <span class="at">trace =</span> F)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Title:
 GARCH Modelling 

Call:
 garchFit(formula = ~arma(1, 0) + garch(1, 4), data = ar.res, 
    trace = F) 

Mean and Variance Equation:
 data ~ arma(1, 0) + garch(1, 4)
&lt;environment: 0x7fce1d6b79f8&gt;
 [data = ar.res]

Conditional Distribution:
 norm 

Coefficient(s):
         mu          ar1        omega       alpha1        beta1        beta2  
-0.00144214   0.00236649  21.18647953   0.00000001   0.97478384   0.00000001  
      beta3        beta4  
 0.00000001   0.00000001  

Std. Errors:
 based on Hessian 

Error Analysis:
         Estimate  Std. Error  t value Pr(&gt;|t|)
mu     -1.442e-03   9.949e-01   -0.001    0.999
ar1     2.366e-03   3.450e-02    0.069    0.945
omega   2.119e+01   1.295e+01    1.636    0.102
alpha1  1.000e-08         NaN      NaN      NaN
beta1   9.748e-01   1.946e+01    0.050    0.960
beta2   1.000e-08   1.567e+01    0.000    1.000
beta3   1.000e-08         NaN      NaN      NaN
beta4   1.000e-08         NaN      NaN      NaN

Log Likelihood:
 -4020.441    normalized:  -4.780548 

Description:
 Wed Nov 22 21:53:37 2023 by user:  


Standardised Residuals Tests:
                                 Statistic      p-Value
 Jarque-Bera Test   R    Chi^2  17.9142074 1.288188e-04
 Shapiro-Wilk Test  R    W       0.9847546 1.124557e-07
 Ljung-Box Test     R    Q(10)   5.0407836 8.884370e-01
 Ljung-Box Test     R    Q(15)  23.1202713 8.161946e-02
 Ljung-Box Test     R    Q(20)  27.8526110 1.129345e-01
 Ljung-Box Test     R^2  Q(10)   7.4106948 6.861867e-01
 Ljung-Box Test     R^2  Q(15)   8.7613151 8.896631e-01
 Ljung-Box Test     R^2  Q(20)  18.7545990 5.378250e-01
 LM Arch Test       R    TR^2    7.4989478 8.229593e-01

Information Criterion Statistics:
     AIC      BIC      SIC     HQIC 
9.580122 9.625159 9.579943 9.597382 </code></pre>
</div>
</div>
<p>Based on the two models, looking at the Ljung-Box Test and the AIC values, we can say that ARCH(1,4) is the best model to predict HYBE stock prices.</p>
</section>
<section id="equation" class="level3">
<h3 class="anchored" data-anchor-id="equation">Equation:</h3>
<p>Based on the model above, we’ll say that equation for the model is as follows:</p>
<p><span class="math inline">\(X_t = 2108 -0.1133z_1+ 1.475z_2 + 5.063z_3 - 1.314z_4\)</span></p>
<p><span class="math inline">\(y^*_t = y_t−0.00134274\)</span></p>
<p><span class="math inline">\(y_t = \sigma_t \epsilon_t\)</span></p>
<p><span class="math inline">\(\sigma^2_t = 21.05589755 + 0.00000001y^2_{t-1} + 0.97494048\sigma^2_{t-1} + 0.00000001\sigma^2_{t-2} + 0.00000001\sigma^2_{t-3} + 0.00000001\sigma^2_{t-4}\)</span></p>
<p>##part 2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> HYBE <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(UMGP, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(WMG, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>hybe <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>HYBE_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>umgp <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>UMGP_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>wmg <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>WMG_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>df2_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hybe, umgp, wmg)</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df2_ts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hybe"</span>, <span class="st">"umgp"</span>, <span class="st">"wmg"</span>)</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(df2_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5600</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Doing an 80/20 split</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(df2)), <span class="at">size =</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(df2)) </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> df2[train_indices, ] </span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> df2[<span class="sc">-</span>train_indices, ]</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co">#First, fitting the model: </span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(HYBE_Price <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking residuals</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = HYBE_Price ~ ., data = train)

Residuals:
    Min      1Q  Median      3Q     Max 
-74.588 -28.629  -1.115  28.270  80.866 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -230.99952   90.35712  -2.557  0.01075 *  
Date           0.01327    0.00452   2.935  0.00342 ** 
UMGP_Price    18.53846    2.67387   6.933 8.23e-12 ***
WMG_Price      4.31327    0.32778  13.159  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 36.72 on 836 degrees of freedom
Multiple R-squared:  0.4113,    Adjusted R-squared:  0.4092 
F-statistic: 194.7 on 3 and 836 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Since all the variables are significant, we’ll continue with this model to find its residuals.</p>
<div class="cell">
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>lm_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">cor</span>(test<span class="sc">$</span>HYBE_Price, lm_predictions)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test<span class="sc">$</span>HYBE_Price <span class="sc">-</span> lm_predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"R-squared:"</span>, r_squared))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R-squared: 0.441803792246388"</code></pre>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE:"</span>, rmse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE: 36.3722980380692"</code></pre>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>lm.residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(lm.residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(lm.residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(lm.residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  lm.residuals
Dickey-Fuller = -9.1461, Lag order = 9, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>We can see that the residuals are stationary in accordance to the Dickey-Fuller test. Additionally, both the ACF and the PACF plots show that the residuals are not auto correlated since the plot is approximately stationary. Thus, we can proceed with these residuals.</p>
<p>Next, using these residuals, we’ll first find the best ARMA/AR/ARIMA model. We’ll do this is two ways, first using auto.arima and then manually by running through multiple models.</p>
</section>
<section id="using-auto.arima-2" class="level3">
<h3 class="anchored" data-anchor-id="using-auto.arima-2">Using auto.arima</h3>
<div class="cell">
<details>
<summary>Auto.arima() code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>arima_model <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(lm.residuals)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arima_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lm.residuals 
ARIMA(0,0,0) with zero mean 

sigma^2 = 1342:  log likelihood = -4216.61
AIC=8435.21   AICc=8435.22   BIC=8439.94

Training set error measures:
                       ME     RMSE      MAE MPE MAPE      MASE        ACF1
Training set 2.257879e-15 36.62861 31.29514 100  100 0.7331305 -0.03285608</code></pre>
</div>
</div>
<p>Auto arima provided the model where p,q,d = 0. This model would not correctly predict, therefore we turn to the manual approach for better output.</p>
</section>
<section id="manual-ararmaarima-model-1" class="level3">
<h3 class="anchored" data-anchor-id="manual-ararmaarima-model-1">Manual AR/ARMA/ARIMA Model</h3>
<div class="cell">
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">25</span>),<span class="at">nrow=</span><span class="dv">25</span>) </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># p=0, 1,2,3, 4</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># q=0, 1,2,3,4</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">10</span>) <span class="co">#usual threshold</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>      model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(lm.residuals,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>      ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>      i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8438.693</td>
<td style="text-align: right;">8452.894</td>
<td style="text-align: right;">8438.722</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8439.816</td>
<td style="text-align: right;">8458.750</td>
<td style="text-align: right;">8439.864</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8440.647</td>
<td style="text-align: right;">8464.314</td>
<td style="text-align: right;">8440.719</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8442.630</td>
<td style="text-align: right;">8471.031</td>
<td style="text-align: right;">8442.731</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8444.116</td>
<td style="text-align: right;">8477.250</td>
<td style="text-align: right;">8444.251</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8439.751</td>
<td style="text-align: right;">8458.684</td>
<td style="text-align: right;">8439.798</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8441.086</td>
<td style="text-align: right;">8464.753</td>
<td style="text-align: right;">8441.158</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8441.905</td>
<td style="text-align: right;">8470.306</td>
<td style="text-align: right;">8442.006</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8443.901</td>
<td style="text-align: right;">8477.035</td>
<td style="text-align: right;">8444.036</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8445.168</td>
<td style="text-align: right;">8483.035</td>
<td style="text-align: right;">8445.341</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8440.617</td>
<td style="text-align: right;">8464.284</td>
<td style="text-align: right;">8440.689</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8441.888</td>
<td style="text-align: right;">8470.288</td>
<td style="text-align: right;">8441.989</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8443.870</td>
<td style="text-align: right;">8477.004</td>
<td style="text-align: right;">8444.004</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8445.826</td>
<td style="text-align: right;">8483.693</td>
<td style="text-align: right;">8445.999</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8446.495</td>
<td style="text-align: right;">8489.096</td>
<td style="text-align: right;">8446.712</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8442.566</td>
<td style="text-align: right;">8470.966</td>
<td style="text-align: right;">8442.667</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8444.601</td>
<td style="text-align: right;">8477.735</td>
<td style="text-align: right;">8444.736</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8445.860</td>
<td style="text-align: right;">8483.727</td>
<td style="text-align: right;">8446.034</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8444.828</td>
<td style="text-align: right;">8487.429</td>
<td style="text-align: right;">8445.045</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8442.662</td>
<td style="text-align: right;">8489.997</td>
<td style="text-align: right;">8442.928</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8444.137</td>
<td style="text-align: right;">8477.270</td>
<td style="text-align: right;">8444.271</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8445.375</td>
<td style="text-align: right;">8483.243</td>
<td style="text-align: right;">8445.549</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8445.013</td>
<td style="text-align: right;">8487.613</td>
<td style="text-align: right;">8445.230</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8441.487</td>
<td style="text-align: right;">8488.821</td>
<td style="text-align: right;">8441.752</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8446.850</td>
<td style="text-align: right;">8498.918</td>
<td style="text-align: right;">8447.169</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Best model: </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 0 0 0 8438.693 8452.894 8438.722</code></pre>
</div>
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 0 0 0 8438.693 8452.894 8438.722</code></pre>
</div>
<details>
<summary>Manual AR/ARMA/ARIMA code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 0 0 0 8438.693 8452.894 8438.722</code></pre>
</div>
</div>
<p>From both auto.arima and the manual approach, we can see that no AR/ARMA/ARIMA model was created from the residuals of the linear regression model. Thus, we can say that there is no autocorrelation in the data that would call for an AR/ARMA/ARIMA model.</p>
<p>From this information, we can deduce the fact that Western record labels (Warner Group and Universal Music Group) do not have an affect on HYBE stock prices. Thus, we can say that HYBE’s success and future would best be predicted by the performance of other KPOP record labels (SM, JYP, and YG). Thus, we can say that for the best financial outcomes, music companies may be looking to KPOP groups and their marketing and music strategies in the coming future.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>