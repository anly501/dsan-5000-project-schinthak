<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Time Series - Shriya Chinthak - ARIMAX, SARIMAX, and VAR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Time Series - Shriya Chinthak</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="http://shriya-chinthak.georgetown.domains" rel="" target="">
 <span class="menu-text">About Me</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./arimax.html">ARIMAX/SARIMAX/VAR</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Sources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARMA/ARIMA/SARIMA Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arimax.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ARIMAX/SARIMAX/VAR</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./saf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spectral Analysis and Filtering (Optional)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./financial-ts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Financial Time Series Models (ARCH/GARCH)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./deep-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep Learning for TS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conclusions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/anly501/dsan-5000-project-schinthak/tree/main/dsan-website/DSAN_5600" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-vizes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aside - Data Vizes in TS</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#key-questions" id="toc-key-questions" class="nav-link active" data-scroll-target="#key-questions">Key Questions:</a></li>
  <li><a href="#the-kpop-record-labels---var" id="toc-the-kpop-record-labels---var" class="nav-link" data-scroll-target="#the-kpop-record-labels---var">(1) The KPOP Record Labels - VAR:</a></li>
  <li><a href="#kpop-and-the-western-industry---var" id="toc-kpop-and-the-western-industry---var" class="nav-link" data-scroll-target="#kpop-and-the-western-industry---var">(2) KPOP and the Western industry - VAR:</a></li>
  <li><a href="#foreign-tourism-in-korea-on-cultural-globalization-in-the-usa" id="toc-foreign-tourism-in-korea-on-cultural-globalization-in-the-usa" class="nav-link" data-scroll-target="#foreign-tourism-in-korea-on-cultural-globalization-in-the-usa">(3) - Foreign tourism in Korea on Cultural Globalization in the USA</a></li>
  <li><a href="#kpop-and-musical-characteristsics" id="toc-kpop-and-musical-characteristsics" class="nav-link" data-scroll-target="#kpop-and-musical-characteristsics">(4) KPOP and Musical Characteristsics</a></li>
  <li><a href="#western-artists-discography-and-musical-characteristsics" id="toc-western-artists-discography-and-musical-characteristsics" class="nav-link" data-scroll-target="#western-artists-discography-and-musical-characteristsics">(5) Western Artists’ Discography and Musical Characteristsics</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ARIMAX, SARIMAX, and VAR</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In order to understand the relationships between the Western Music industry and KPOP, we must take a look at their relationships between the artists. Focusing on KPOP, the biggest record label as of 2023 within the KPOP music industry is HYBE, now an international music company housing the biggest KPOP group, BTS. However, the other notable groups which we’ll be focusing on are EXO, Twice, and Black Pink, all of which are signed to other record labels known as SM, JYP, and YG respectfully. In terms of sales and popularity, BTS seems to be far above the other noted groups in their reach into the western music industry, especially of of recent with their total of 5 Grammy nominations <span class="citation" data-cites="grammy"><span>“BTS | Artist”</span> (<a href="#ref-grammy" role="doc-biblioref">2022</a>)</span>. Thus, we will use a an ARIMAX model in order to discover what the relationship between other KPOP groups have with BTS and forecast the stock prices of these record labels using this information.</p>
<p>The next relationship we’ll analyze is between HYBE and the Western record labels Universal Music and Warner music. These two massive conglomerates make up the majority of the music industry within the west. However, with the recent merger of HYBE with Ithaca Holdings in 2021, there is reason to believe there is now overlap between HYBE and the western industry. Thus, we’ll see Universal Music Group and Warner’s relationship on HYBE and whether it’s significant.</p>
<p>Lastly, we’ll take a look at the relationship between globalization and tourism inbound in Korea in order to see whether foreign travel into Korea has a direct correlation within cultural globalization worldwide. This allows us to better understand the significance of KPOP and Korean culture onto other countries, specifically the western market and music industry.</p>
<section id="key-questions" class="level3">
<h3 class="anchored" data-anchor-id="key-questions">Key Questions:</h3>
<ol type="1">
<li>What is the relationship between KPOP groups?</li>
<li>What is the relationship between HYBE and the Western industry?</li>
<li>What is the relationship between cultural globalization and Korean tourism?</li>
<li>Can musical characteristics be used to predict the popularity of KPOP?</li>
<li>Can musical characteristics be used to predict the popularity of western music?</li>
</ol>
</section>
<section id="the-kpop-record-labels---var" class="level2">
<h2 class="anchored" data-anchor-id="the-kpop-record-labels---var">(1) The KPOP Record Labels - VAR:</h2>
<p>Firstly, let’s gather the stock data for HYBE, SM Entertainment, YG, and JYP. Once gathered, we will be cleaning the data in order to impute weekends or holidays throughout the year where the stock market is closed.</p>
<div class="cell">
<details>
<summary>Data Collection</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.warning4.0"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"getSymbols.yahoo.warning"</span><span class="ot">=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tickers <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"UMGP"</span>, <span class="st">"SONY"</span>, <span class="st">"352820.KS"</span>, <span class="st">"041510.KQ"</span>, <span class="st">'122870.KQ'</span>, <span class="st">'035900.KQ'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> tickers){</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getSymbols</span>(i, <span class="at">from =</span> <span class="st">"2000-01-01"</span>, <span class="at">to =</span> <span class="st">"2023-11-01"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(UMGP<span class="sc">$</span>UMGP.Adjusted)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> UMGP <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">UMGP_Price =</span> UMGP.Adjusted)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(UMGP<span class="sc">$</span>Date))  </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(UMGP<span class="sc">$</span>Date))    </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> <span class="fu">merge</span>(UMGP, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> UMGP[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(UMGP)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> UMGP[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(UMGP)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(UMGP, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>UMGP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>SONY <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SONY<span class="sc">$</span>SONY.Adjusted)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>SONY <span class="ot">&lt;-</span> SONY <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SONY_Price =</span> SONY.Adjusted)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(SONY<span class="sc">$</span>Date))  </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(SONY<span class="sc">$</span>Date))    </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>SONY <span class="ot">&lt;-</span> <span class="fu">merge</span>(SONY, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> SONY[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(SONY)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> SONY[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(SONY)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(SONY, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>SONY <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">352820.KS</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">352820.KS.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> HYBE <span class="sc">%&gt;%</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">HYBE_Price =</span> X352820.KS.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HYBE_Price =</span> HYBE_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(HYBE<span class="sc">$</span>Date))  </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(HYBE<span class="sc">$</span>Date))    </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> <span class="fu">merge</span>(HYBE, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> HYBE[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(HYBE)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> HYBE[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(HYBE)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(HYBE, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>HYBE <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co">#--- </span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">041510.KQ</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">041510.KQ.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> SM <span class="sc">%&gt;%</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SM_Price =</span> X041510.KQ.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SM_Price =</span> SM_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(SM<span class="sc">$</span>Date))  </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(SM<span class="sc">$</span>Date))    </span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> <span class="fu">merge</span>(SM, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> SM[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(SM)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> SM[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(SM)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(SM, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>SM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">122870.KQ</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">122870.KQ.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> YG <span class="sc">%&gt;%</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">YG_Price =</span> X122870.KQ.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YG_Price =</span> YG_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(YG<span class="sc">$</span>Date))  </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(YG<span class="sc">$</span>Date))    </span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> <span class="fu">merge</span>(YG, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> YG[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(YG)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> YG[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(YG)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(YG, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>YG <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">035900.KQ</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">035900.KQ.Adjusted</span><span class="st">`</span>)</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> JYP <span class="sc">%&gt;%</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">JYP_Price =</span> X035900.KQ.Adjusted) <span class="sc">%&gt;%</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">JYP_Price =</span> JYP_Price<span class="sc">/</span><span class="fl">1352.60</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(JYP<span class="sc">$</span>Date))  </span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(JYP<span class="sc">$</span>Date))    </span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>date_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_date, end_date, <span class="at">by =</span> <span class="st">"1 day"</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>date_dataset <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> date_range)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> <span class="fu">merge</span>(JYP, date_dataset, <span class="at">by =</span> <span class="st">'Date'</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>df_na_rows <span class="ot">&lt;-</span> JYP[<span class="fu">which</span>(<span class="fu">rowSums</span>(<span class="fu">is.na</span>(JYP)) <span class="sc">&gt;</span> <span class="dv">0</span>),]</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>df_na_cols <span class="ot">&lt;-</span> JYP[, <span class="fu">which</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(JYP)) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>imputed_time_series <span class="ot">&lt;-</span> <span class="fu">na_ma</span>(JYP, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">weighting =</span> <span class="st">"exponential"</span>)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>JYP <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(imputed_time_series)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>stock_dataframes <span class="ot">&lt;-</span> <span class="fu">list</span>(UMGP, SONY, HYBE, SM, YG, JYP)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>stock_names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"UMGP"</span>, <span class="st">"SONY"</span>, <span class="st">"HYBE"</span>, <span class="st">"SM"</span>, <span class="st">"YG"</span>, <span class="st">"JYP"</span>)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a subset of only Korean Record label stock data</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> HYBE <span class="sc">%&gt;%</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(SM, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(YG, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(JYP, <span class="at">by =</span> <span class="st">'Date'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">VARselect</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Initial selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Cross Validation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Model Creation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>As we previously mentioned in data visualization, HYBE seems to have a much larger impact in comparison to the other three record companies on the stock market overall. However, what we can see is that several of the positive trends shown through all stock prices, thus we can note some initial correlation. Let’s continue with the VAR model to see what the multivariate relationship is.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>hybe <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>HYBE_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sm <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>SM_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>yg <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>YG_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>jyp <span class="ot">&lt;-</span> <span class="fu">ts</span>(df<span class="sc">$</span>JYP_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hybe, sm, yg, jyp)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_ts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hybe"</span>, <span class="st">"sm"</span>, <span class="st">"yg"</span>, <span class="st">"jyp"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(df_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>We can see that the p-values detected from VARselect() are 5 and 1.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(df_ts, <span class="at">lag.max=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
     5      1      1      5 

$criteria
               1         2         3         4         5         6         7
AIC(n)  3.242792  3.219427  3.228749  3.220574  3.199157  3.202723  3.219911
HQ(n)   3.283992  3.288094  3.324882  3.344174  3.350223  3.381255  3.425910
SC(n)   3.351712  3.400961  3.482896  3.547335  3.598531  3.674710  3.764512
FPE(n) 25.605120 25.013843 25.248200 25.042793 24.512385 24.600279 25.027247
               8         9        10
AIC(n)  3.219738  3.224843  3.237679
HQ(n)   3.453203  3.485775  3.526077
SC(n)   3.836952  3.914670  4.000120
FPE(n) 25.023519 25.152364 25.478278</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>We can see that based on the residual standard error and number of significant variables in the model, we can say that the model when p=5 performs better than when p=1. We can also notice that while HYBE and SM don’t see to have much correlation with other agencies, JYP and YG seem to be heavily correlated with each other and SM.</p>
<p>Thus, before we continue with the model, we will also verify through a CV test.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, sm, yg, jyp 
Deterministic variables: both 
Sample size: 1112 
Log Likelihood: -8136.588 
Roots of the characteristic polynomial:
0.9951 0.9852 0.9848 0.9848
Call:
vars::VAR(y = df_ts, p = 1, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.9921208  0.0045176 219.613   &lt;2e-16 ***
sm.l1   -0.0018632  0.0188413  -0.099    0.921    
yg.l1    0.0497758  0.0356334   1.397    0.163    
jyp.l1  -0.0266689  0.0184253  -1.447    0.148    
const    0.1284624  0.7858872   0.163    0.870    
trend    0.0008352  0.0013929   0.600    0.549    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.55 on 1106 degrees of freedom
Multiple R-Squared: 0.9905, Adjusted R-squared: 0.9905 
F-statistic: 2.312e+04 on 5 and 1106 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation sm: 
=================================== 
sm = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0022859  0.0016335   1.399   0.1620    
sm.l1    0.9794874  0.0068128 143.771   &lt;2e-16 ***
yg.l1   -0.0052246  0.0128847  -0.405   0.6852    
jyp.l1   0.0040576  0.0066624   0.609   0.5426    
const    0.1457548  0.2841683   0.513   0.6081    
trend    0.0011518  0.0005037   2.287   0.0224 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.645 on 1106 degrees of freedom
Multiple R-Squared: 0.9947, Adjusted R-squared: 0.9947 
F-statistic: 4.144e+04 on 5 and 1106 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation yg: 
=================================== 
yg = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  5.948e-04  1.022e-03   0.582   0.5606    
sm.l1   -9.013e-05  4.261e-03  -0.021   0.9831    
yg.l1    9.893e-01  8.059e-03 122.759   &lt;2e-16 ***
jyp.l1  -2.273e-03  4.167e-03  -0.545   0.5856    
const    3.077e-01  1.777e-01   1.731   0.0837 .  
trend    2.684e-04  3.150e-04   0.852   0.3945    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.029 on 1106 degrees of freedom
Multiple R-Squared: 0.9854, Adjusted R-squared: 0.9854 
F-statistic: 1.496e+04 on 5 and 1106 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation jyp: 
==================================== 
jyp = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0004462  0.0011666   0.382 0.702200    
sm.l1   -0.0132044  0.0048656  -2.714 0.006754 ** 
yg.l1    0.0174207  0.0092019   1.893 0.058598 .  
jyp.l1   0.9889679  0.0047581 207.847  &lt; 2e-16 ***
const   -0.2480215  0.2029470  -1.222 0.221930    
trend    0.0012691  0.0003597   3.528 0.000436 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.175 on 1106 degrees of freedom
Multiple R-Squared: 0.9968, Adjusted R-squared: 0.9968 
F-statistic: 6.933e+04 on 5 and 1106 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
       hybe     sm     yg    jyp
hybe 20.704 2.3158 2.2466 2.0437
sm    2.316 2.7070 0.7833 0.9799
yg    2.247 0.7833 1.0590 0.7404
jyp   2.044 0.9799 0.7404 1.3807

Correlation matrix of residuals:
       hybe     sm     yg    jyp
hybe 1.0000 0.3093 0.4798 0.3822
sm   0.3093 1.0000 0.4626 0.5069
yg   0.4798 0.4626 1.0000 0.6123
jyp  0.3822 0.5069 0.6123 1.0000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, sm, yg, jyp 
Deterministic variables: both 
Sample size: 1108 
Log Likelihood: -7965.483 
Roots of the characteristic polynomial:
0.9934 0.9884 0.9748 0.9748 0.6644 0.6644 0.6176 0.6176 0.5959 0.5872 0.5872 0.5846 0.5535 0.5535 0.4478 0.4478 0.368 0.361 0.361 0.2776
Call:
vars::VAR(y = df_ts, p = 5, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  8.666e-01  3.500e-02  24.757  &lt; 2e-16 ***
sm.l1   -7.648e-02  9.509e-02  -0.804  0.42141    
yg.l1    9.170e-02  1.749e-01   0.524  0.60026    
jyp.l1   4.908e-02  1.511e-01   0.325  0.74533    
hybe.l2  1.363e-01  4.652e-02   2.931  0.00345 ** 
sm.l2    6.649e-02  1.331e-01   0.499  0.61762    
yg.l2   -2.466e-02  2.371e-01  -0.104  0.91719    
jyp.l2  -3.686e-02  2.013e-01  -0.183  0.85474    
hybe.l3  9.552e-02  4.668e-02   2.046  0.04097 *  
sm.l3    1.047e-01  1.337e-01   0.784  0.43343    
yg.l3   -1.329e-01  2.381e-01  -0.558  0.57692    
jyp.l3  -1.400e-01  2.016e-01  -0.694  0.48760    
hybe.l4  3.769e-02  4.527e-02   0.833  0.40529    
sm.l4    7.740e-03  1.335e-01   0.058  0.95378    
yg.l4   -2.363e-01  2.378e-01  -0.993  0.32072    
jyp.l4   1.863e-01  1.994e-01   0.934  0.35038    
hybe.l5 -1.445e-01  3.320e-02  -4.353 1.47e-05 ***
sm.l5   -1.017e-01  9.564e-02  -1.064  0.28763    
yg.l5    3.428e-01  1.753e-01   1.956  0.05077 .  
jyp.l5  -7.712e-02  1.493e-01  -0.517  0.60549    
const    5.604e-01  7.647e-01   0.733  0.46382    
trend    7.224e-05  1.366e-03   0.053  0.95783    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.309 on 1086 degrees of freedom
Multiple R-Squared: 0.9916, Adjusted R-squared: 0.9915 
F-statistic:  6138 on 21 and 1086 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation sm: 
=================================== 
sm = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0123021  0.0133322   0.923  0.35635    
sm.l1    0.9698567  0.0362187  26.778  &lt; 2e-16 ***
yg.l1   -0.1343447  0.0666337  -2.016  0.04403 *  
jyp.l1  -0.0179767  0.0575447  -0.312  0.75480    
hybe.l2 -0.0117678  0.0177207  -0.664  0.50679    
sm.l2    0.0861901  0.0507148   1.700  0.08951 .  
yg.l2    0.1421564  0.0903041   1.574  0.11573    
jyp.l2  -0.0742571  0.0766642  -0.969  0.33296    
hybe.l3 -0.0002388  0.0177806  -0.013  0.98929    
sm.l3    0.0225817  0.0509103   0.444  0.65745    
yg.l3    0.0346174  0.0907076   0.382  0.70281    
jyp.l3  -0.0098724  0.0768007  -0.129  0.89774    
hybe.l4  0.0091121  0.0172430   0.528  0.59730    
sm.l4   -0.0880014  0.0508560  -1.730  0.08384 .  
yg.l4   -0.0424794  0.0905886  -0.469  0.63922    
jyp.l4   0.1157384  0.0759455   1.524  0.12781    
hybe.l5 -0.0071435  0.0126460  -0.565  0.57227    
sm.l5   -0.0160131  0.0364279  -0.440  0.66033    
yg.l5    0.0020312  0.0667619   0.030  0.97573    
jyp.l5  -0.0110284  0.0568540  -0.194  0.84623    
const    0.0150316  0.2912850   0.052  0.95885    
trend    0.0014489  0.0005203   2.785  0.00545 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.641 on 1086 degrees of freedom
Multiple R-Squared: 0.9948, Adjusted R-squared: 0.9947 
F-statistic:  9848 on 21 and 1086 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation yg: 
=================================== 
yg = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1 -0.0025310  0.0082685  -0.306  0.75959    
sm.l1   -0.0073974  0.0224625  -0.329  0.74198    
yg.l1    0.8726604  0.0413256  21.117  &lt; 2e-16 ***
jyp.l1   0.0043162  0.0356887   0.121  0.90376    
hybe.l2  0.0034849  0.0109902   0.317  0.75123    
sm.l2   -0.0133676  0.0314528  -0.425  0.67092    
yg.l2    0.1827504  0.0560057   3.263  0.00114 ** 
jyp.l2  -0.0107837  0.0475464  -0.227  0.82062    
hybe.l3  0.0003741  0.0110274   0.034  0.97295    
sm.l3    0.0417774  0.0315740   1.323  0.18606    
yg.l3    0.0189166  0.0562560   0.336  0.73674    
jyp.l3   0.0138021  0.0476311   0.290  0.77205    
hybe.l4  0.0048569  0.0106940   0.454  0.64980    
sm.l4   -0.0303542  0.0315404  -0.962  0.33607    
yg.l4    0.0032207  0.0561822   0.057  0.95430    
jyp.l4   0.0025712  0.0471007   0.055  0.95647    
hybe.l5 -0.0053013  0.0078429  -0.676  0.49923    
sm.l5    0.0097723  0.0225923   0.433  0.66543    
yg.l5   -0.0937187  0.0414051  -2.263  0.02380 *  
jyp.l5  -0.0098661  0.0352603  -0.280  0.77968    
const    0.3979779  0.1806522   2.203  0.02780 *  
trend    0.0001869  0.0003227   0.579  0.56262    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.018 on 1086 degrees of freedom
Multiple R-Squared: 0.9859, Adjusted R-squared: 0.9857 
F-statistic:  3628 on 21 and 1086 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation jyp: 
==================================== 
jyp = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0027699  0.0093754   0.295  0.76771    
sm.l1   -0.0100466  0.0254694  -0.394  0.69332    
yg.l1   -0.0900842  0.0468577  -1.923  0.05480 .  
jyp.l1   0.8924036  0.0404662  22.053  &lt; 2e-16 ***
hybe.l2 -0.0034290  0.0124614  -0.275  0.78324    
sm.l2   -0.0358290  0.0356633  -1.005  0.31529    
yg.l2    0.1554553  0.0635030   2.448  0.01452 *  
jyp.l2   0.1112857  0.0539112   2.064  0.03923 *  
hybe.l3  0.0074929  0.0125036   0.599  0.54912    
sm.l3    0.0775470  0.0358007   2.166  0.03052 *  
yg.l3   -0.0954436  0.0637868  -1.496  0.13487    
jyp.l3  -0.0157842  0.0540073  -0.292  0.77014    
hybe.l4 -0.0055911  0.0121255  -0.461  0.64482    
sm.l4   -0.0960331  0.0357626  -2.685  0.00736 ** 
yg.l4    0.1577294  0.0637031   2.476  0.01344 *  
jyp.l4   0.0690271  0.0534059   1.293  0.19646    
hybe.l5 -0.0009265  0.0088928  -0.104  0.91704    
sm.l5    0.0524032  0.0256166   2.046  0.04103 *  
yg.l5   -0.1109220  0.0469478  -2.363  0.01832 *  
jyp.l5  -0.0673070  0.0399805  -1.683  0.09257 .  
const   -0.2324598  0.2048354  -1.135  0.25668    
trend    0.0011635  0.0003659   3.180  0.00151 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.154 on 1086 degrees of freedom
Multiple R-Squared: 0.997,  Adjusted R-squared: 0.9969 
F-statistic: 1.705e+04 on 21 and 1086 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
       hybe     sm     yg    jyp
hybe 18.566 2.2572 2.1782 2.0336
sm    2.257 2.6937 0.7721 0.9678
yg    2.178 0.7721 1.0361 0.7146
jyp   2.034 0.9678 0.7146 1.3320

Correlation matrix of residuals:
       hybe     sm     yg    jyp
hybe 1.0000 0.3192 0.4966 0.4089
sm   0.3192 1.0000 0.4622 0.5109
yg   0.4966 0.4622 1.0000 0.6083
jyp  0.4089 0.5109 0.6083 1.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>The results from the CV test show that a model of p = 2 is the best at predicting HYBE stock prices in relation to SM, YG, and JYP. Since cross validation is a more accurate model selection technique, we will create both models where p=5,2.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">=</span> <span class="dv">5</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>best_performance <span class="ot">&lt;-</span> <span class="cn">Inf</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>fold_s <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">nrow</span>(df_ts)<span class="sc">/</span>folds)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>folds){</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">&lt;-</span> (fold<span class="dv">-1</span>)<span class="sc">*</span>fold_s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  end <span class="ot">&lt;-</span> fold<span class="sc">*</span>fold_s</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  train_model <span class="ot">&lt;-</span> df_ts[<span class="sc">-</span>(start<span class="sc">:</span>end), ]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  test_model <span class="ot">&lt;-</span> df_ts[start<span class="sc">:</span>end, ]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  sel <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(train_model, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"both"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  best_lag <span class="ot">&lt;-</span> sel<span class="sc">$</span>selection[<span class="dv">1</span>]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(train_model, <span class="at">p=</span>best_lag, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">nrow</span>(test_model)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> h)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  pred_hybe <span class="ot">&lt;-</span> pred<span class="sc">$</span>fcst<span class="sc">$</span>hybe[,<span class="dv">1</span>]</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_hybe <span class="sc">-</span> test_model[, <span class="st">"hybe"</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(mse <span class="sc">&lt;</span> best_performance){</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> fit</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    best_performance <span class="ot">&lt;-</span> mse</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The best model is: "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The best model is: "</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
======================= 

Estimated coefficients for equation hybe: 
========================================= 
Call:
hybe = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

    hybe.l1       sm.l1       yg.l1      jyp.l1     hybe.l2       sm.l2 
 0.87201090  0.07620422  0.12286552 -0.06907358  0.14729914 -0.16491675 
      yg.l2      jyp.l2     hybe.l3       sm.l3       yg.l3      jyp.l3 
-0.13573997  0.09858174  0.07480327  0.19763602  0.02451796 -0.21327938 
    hybe.l4       sm.l4       yg.l4      jyp.l4     hybe.l5       sm.l5 
 0.04568771 -0.10244127 -0.32590355  0.26826401 -0.15423436  0.02001372 
      yg.l5      jyp.l5       const       trend 
 0.36987287 -0.11603480  1.02527774 -0.00139024 


Estimated coefficients for equation sm: 
======================================= 
Call:
sm = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

     hybe.l1        sm.l1        yg.l1       jyp.l1      hybe.l2        sm.l2 
 0.013590927  0.904810180 -0.066399663 -0.017876496 -0.017337965  0.033487971 
       yg.l2       jyp.l2      hybe.l3        sm.l3        yg.l3       jyp.l3 
 0.098164606 -0.040342672  0.004615891  0.122606007  0.081009347 -0.076273593 
     hybe.l4        sm.l4        yg.l4       jyp.l4      hybe.l5        sm.l5 
 0.003105172 -0.095496986 -0.059110240  0.108857574 -0.004531457  0.009438322 
       yg.l5       jyp.l5        const        trend 
-0.033332437  0.027366242 -0.130596272  0.001510519 


Estimated coefficients for equation yg: 
======================================= 
Call:
yg = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

      hybe.l1         sm.l1         yg.l1        jyp.l1       hybe.l2 
-2.070656e-03 -2.005516e-04  8.934663e-01 -5.029658e-03  5.052568e-03 
        sm.l2         yg.l2        jyp.l2       hybe.l3         sm.l3 
 1.241973e-02  1.414959e-01  1.553195e-04 -1.672154e-03  5.480095e-03 
        yg.l3        jyp.l3       hybe.l4         sm.l4         yg.l4 
 3.398433e-02  1.783199e-02  3.108653e-03 -1.486596e-02  6.449618e-03 
       jyp.l4       hybe.l5         sm.l5         yg.l5        jyp.l5 
-5.388133e-03 -4.889926e-03  2.540147e-03 -9.355377e-02 -9.266047e-03 
        const         trend 
 6.386321e-01  6.745231e-05 


Estimated coefficients for equation jyp: 
======================================== 
Call:
jyp = hybe.l1 + sm.l1 + yg.l1 + jyp.l1 + hybe.l2 + sm.l2 + yg.l2 + jyp.l2 + hybe.l3 + sm.l3 + yg.l3 + jyp.l3 + hybe.l4 + sm.l4 + yg.l4 + jyp.l4 + hybe.l5 + sm.l5 + yg.l5 + jyp.l5 + const + trend 

      hybe.l1         sm.l1         yg.l1        jyp.l1       hybe.l2 
 0.0070298491 -0.0129008256 -0.0943891017  0.9078152165 -0.0082283937 
        sm.l2         yg.l2        jyp.l2       hybe.l3         sm.l3 
-0.0090787198  0.1227334552  0.1154161887  0.0096857545  0.0368680862 
        yg.l3        jyp.l3       hybe.l4         sm.l4         yg.l4 
-0.0457953112 -0.0271650685 -0.0109405883 -0.0698842398  0.1382804710 
       jyp.l4       hybe.l5         sm.l5         yg.l5        jyp.l5 
 0.0798251451  0.0006612204  0.0480291483 -0.1008826046 -0.0847061863 
        const         trend 
-0.1013654507  0.0009041013 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Based on the p-values, we can say that the model where p=2 has a much lower p-value, indicating that there is no serial correlation within the model. Thus, we will choose this model to forecast HYBE prices in relation to other KPOP agencies.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_1, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_1
Chi-squared = 268.25, df = 160, p-value = 1.768e-07</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"jyp"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"yg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>var_model_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_2, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_2
Chi-squared = 161.03, df = 112, p-value = 0.001666</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"jyp"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"yg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-7-8.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df_ts, <span class="at">p=</span><span class="dv">2</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>fit.pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(var_model_1, <span class="at">n.ahead =</span> <span class="dv">365</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fanchart</span>(fit.pr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Thus, from our forecasting, we can see that SM, JYP, and YG all are similar in that the so a contextually upward trend of similar magnitude. Additionally, we see a downward trend for HYBE in the next year with a larger variance within the prediction. This could mean that, if HYBE were to proceed with business decisions based on KPOP record labels, they would face a downward trend in their stock prices.</p>
<hr>
</section>
<section id="kpop-and-the-western-industry---var" class="level2">
<h2 class="anchored" data-anchor-id="kpop-and-the-western-industry---var">(2) KPOP and the Western industry - VAR:</h2>
<p>Similarly, we’ll take look now at how or if the Western music industry has had a relation with the growth and sucess of HYBE entertainment. As we see the blend of the two industries within HYBE’s artist roster, we will also need to use the techinques of VAR models to identify correlations between all three entertainment companies in order to properly forecast all three.</p>
<p>We’ll follow the same steps as before the get some initial p values from VARselect().</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">VARselect</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Initial selection</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Cross Validation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Model Creation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>From an initial visualization, it doesn’t appear that there is correlation between any of these stock prices, simply because the trends are so vastly different. HYBE, compared to the other stock prices, seems much more volatile, which makes it difficult to predict its forecasted prices. Thus, we’ll continue with the VAR model to work on forecasting.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a subset of only Korean Record label stock data</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> HYBE <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(UMGP, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(SONY, <span class="at">by =</span> <span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>hybe <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>HYBE_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>umgp <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>UMGP_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>sony <span class="ot">&lt;-</span> <span class="fu">ts</span>(df2<span class="sc">$</span>SONY_Price, <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">'2020-10-15'</span>), <span class="at">freq =</span> <span class="fl">365.25</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>df2_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hybe, umgp, sony)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df2_ts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"hybe"</span>, <span class="st">"umgp"</span>, <span class="st">"sony"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(df2_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Here, we can see that VARselect() chose p=5,1, similar to the relation between KPOP agencies. Let’s continue by analyzing the residuals squared errors.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(df2_ts, <span class="at">lag.max=</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$selection
AIC(n)  HQ(n)  SC(n) FPE(n) 
     5      5      2      5 

$criteria
                1          2          3         4          5          6
AIC(n) -1.3950763 -1.4375108 -1.4515832 -1.479774 -1.4963602 -1.4920916
HQ(n)  -1.3693066 -1.3962793 -1.3948899 -1.407619 -1.4087432 -1.3890127
SC(n)  -1.3269518 -1.3285116 -1.3017093 -1.289026 -1.2647368 -1.2195935
FPE(n)  0.2478142  0.2375184  0.2341997  0.227690  0.2239454  0.2249045
                7          8          9         10
AIC(n) -1.4839639 -1.4794227 -1.4779850 -1.4706681
HQ(n)  -1.3654232 -1.3454202 -1.3285207 -1.3057419
SC(n)  -1.1705911 -1.1251752 -1.0828628 -1.0346711
FPE(n)  0.2267413  0.2277751  0.2281051  0.2297832</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>From the residual squared errors and significance values, we can see that both models are very similar. The error on UMGP and SONY are very low, however the error for HYBE is larger at at approximately 4. Thus, we’ll continue model selection through cross validation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, umgp, sony 
Deterministic variables: both 
Sample size: 1111 
Log Likelihood: -3972.286 
Roots of the characteristic polynomial:
0.9963 0.9735 0.9735
Call:
vars::VAR(y = df2_ts, p = 1, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + umgp.l1 + sony.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.9775055  0.0049785 196.345  &lt; 2e-16 ***
umgp.l1 -0.1810678  0.2740135  -0.661 0.508879    
sony.l1  0.0904280  0.0200664   4.506 7.29e-06 ***
const   -5.4559803  1.5408192  -3.541 0.000415 ***
trend    0.0015295  0.0005461   2.800 0.005192 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.506 on 1106 degrees of freedom
Multiple R-Squared: 0.9907, Adjusted R-squared: 0.9907 
F-statistic: 2.947e+04 on 4 and 1106 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation umgp: 
===================================== 
umgp = hybe.l1 + umgp.l1 + sony.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  2.330e-04  9.114e-05   2.557   0.0107 *  
umgp.l1  9.888e-01  5.016e-03 197.115   &lt;2e-16 ***
sony.l1 -6.789e-04  3.674e-04  -1.848   0.0648 .  
const    4.078e-02  2.821e-02   1.446   0.1486    
trend   -1.835e-05  9.999e-06  -1.836   0.0667 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.0825 on 1106 degrees of freedom
Multiple R-Squared: 0.9821, Adjusted R-squared: 0.982 
F-statistic: 1.518e+04 on 4 and 1106 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation sony: 
===================================== 
sony = hybe.l1 + umgp.l1 + sony.l1 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0020771  0.0015281   1.359  0.17433    
umgp.l1  0.2268382  0.0841031   2.697  0.00710 ** 
sony.l1  0.9767838  0.0061590 158.595  &lt; 2e-16 ***
const    2.0234611  0.4729243   4.279 2.04e-05 ***
trend   -0.0005467  0.0001676  -3.261  0.00114 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.383 on 1106 degrees of freedom
Multiple R-Squared: 0.9899, Adjusted R-squared: 0.9899 
F-statistic: 2.72e+04 on 4 and 1106 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
          hybe      umgp     sony
hybe 20.308515 -0.006463 0.796670
umgp -0.006463  0.006807 0.005349
sony  0.796670  0.005349 1.913190

Correlation matrix of residuals:
         hybe     umgp    sony
hybe  1.00000 -0.01738 0.12781
umgp -0.01738  1.00000 0.04688
sony  0.12781  0.04688 1.00000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">'both'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
========================= 
Endogenous variables: hybe, umgp, sony 
Deterministic variables: both 
Sample size: 1107 
Log Likelihood: -3827.865 
Roots of the characteristic polynomial:
0.995 0.975 0.975 0.6454 0.6454 0.6308 0.6066 0.6066 0.6043 0.6043 0.5732 0.5062 0.5062 0.4185 0.4185
Call:
vars::VAR(y = df2_ts, p = 5, type = "both")


Estimation results for equation hybe: 
===================================== 
hybe = hybe.l1 + umgp.l1 + sony.l1 + hybe.l2 + umgp.l2 + sony.l2 + hybe.l3 + umgp.l3 + sony.l3 + hybe.l4 + umgp.l4 + sony.l4 + hybe.l5 + umgp.l5 + sony.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.8585565  0.0302880  28.346  &lt; 2e-16 ***
umgp.l1 -0.8961802  1.6111709  -0.556  0.57817    
sony.l1  0.2117222  0.0960607   2.204  0.02773 *  
hybe.l2  0.1281907  0.0398537   3.217  0.00134 ** 
umgp.l2  2.5151241  2.1335925   1.179  0.23873    
sony.l2 -0.0942796  0.1253821  -0.752  0.45225    
hybe.l3  0.0847483  0.0401566   2.110  0.03505 *  
umgp.l3 -1.6093088  2.0866228  -0.771  0.44073    
sony.l3  0.0679304  0.1264693   0.537  0.59129    
hybe.l4  0.0371282  0.0391064   0.949  0.34262    
umgp.l4  2.6130331  2.1355444   1.224  0.22137    
sony.l4 -0.1430621  0.1247935  -1.146  0.25189    
hybe.l5 -0.1240648  0.0290143  -4.276 2.07e-05 ***
umgp.l5 -2.7978227  1.6122588  -1.735  0.08296 .  
sony.l5  0.0138660  0.0953958   0.145  0.88446    
const   -2.9624994  1.5462767  -1.916  0.05564 .  
trend    0.0007640  0.0005389   1.418  0.15658    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 4.275 on 1090 degrees of freedom
Multiple R-Squared: 0.9917, Adjusted R-squared: 0.9916 
F-statistic:  8185 on 16 and 1090 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation umgp: 
===================================== 
umgp = hybe.l1 + umgp.l1 + sony.l1 + hybe.l2 + umgp.l2 + sony.l2 + hybe.l3 + umgp.l3 + sony.l3 + hybe.l4 + umgp.l4 + sony.l4 + hybe.l5 + umgp.l5 + sony.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1 -6.217e-05  5.683e-04  -0.109  0.91290    
umgp.l1  8.711e-01  3.023e-02  28.815  &lt; 2e-16 ***
sony.l1 -3.857e-03  1.802e-03  -2.140  0.03258 *  
hybe.l2  3.841e-04  7.478e-04   0.514  0.60762    
umgp.l2  1.522e-03  4.003e-02   0.038  0.96969    
sony.l2 -1.754e-04  2.353e-03  -0.075  0.94059    
hybe.l3 -6.906e-05  7.535e-04  -0.092  0.92698    
umgp.l3  2.785e-01  3.915e-02   7.114 2.04e-12 ***
sony.l3  8.672e-04  2.373e-03   0.365  0.71483    
hybe.l4 -4.933e-05  7.337e-04  -0.067  0.94641    
umgp.l4 -7.645e-02  4.007e-02  -1.908  0.05667 .  
sony.l4  3.132e-03  2.341e-03   1.338  0.18131    
hybe.l5  1.236e-05  5.444e-04   0.023  0.98188    
umgp.l5 -8.437e-02  3.025e-02  -2.789  0.00538 ** 
sony.l5 -6.482e-04  1.790e-03  -0.362  0.71730    
const    4.427e-02  2.901e-02   1.526  0.12729    
trend   -2.015e-05  1.011e-05  -1.992  0.04657 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 0.08021 on 1090 degrees of freedom
Multiple R-Squared: 0.9833, Adjusted R-squared: 0.9831 
F-statistic:  4013 on 16 and 1090 DF,  p-value: &lt; 2.2e-16 


Estimation results for equation sony: 
===================================== 
sony = hybe.l1 + umgp.l1 + sony.l1 + hybe.l2 + umgp.l2 + sony.l2 + hybe.l3 + umgp.l3 + sony.l3 + hybe.l4 + umgp.l4 + sony.l4 + hybe.l5 + umgp.l5 + sony.l5 + const + trend 

          Estimate Std. Error t value Pr(&gt;|t|)    
hybe.l1  0.0319761  0.0096241   3.322 0.000922 ***
umgp.l1  0.7141464  0.5119557   1.395 0.163319    
sony.l1  0.8387330  0.0305237  27.478  &lt; 2e-16 ***
hybe.l2 -0.0352369  0.0126637  -2.783 0.005487 ** 
umgp.l2  0.4475506  0.6779571   0.660 0.509300    
sony.l2  0.1899306  0.0398406   4.767 2.12e-06 ***
hybe.l3  0.0001916  0.0127599   0.015 0.988022    
umgp.l3 -0.4656160  0.6630323  -0.702 0.482672    
sony.l3  0.0710732  0.0401861   1.769 0.077240 .  
hybe.l4  0.0026579  0.0124262   0.214 0.830668    
umgp.l4 -0.8659717  0.6785773  -1.276 0.202172    
sony.l4 -0.0442994  0.0396536  -1.117 0.264172    
hybe.l5  0.0026997  0.0092194   0.293 0.769706    
umgp.l5  0.3873823  0.5123013   0.756 0.449716    
sony.l5 -0.0796289  0.0303124  -2.627 0.008736 ** 
const    2.0884103  0.4913353   4.250 2.32e-05 ***
trend   -0.0005505  0.0001712  -3.215 0.001343 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 1.358 on 1090 degrees of freedom
Multiple R-Squared: 0.9903, Adjusted R-squared: 0.9902 
F-statistic:  6991 on 16 and 1090 DF,  p-value: &lt; 2.2e-16 



Covariance matrix of residuals:
          hybe      umgp     sony
hybe 18.274389 -0.006924 0.804549
umgp -0.006924  0.006433 0.006025
sony  0.804549  0.006025 1.845119

Correlation matrix of residuals:
         hybe     umgp   sony
hybe  1.00000 -0.02019 0.1386
umgp -0.02019  1.00000 0.0553
sony  0.13855  0.05530 1.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>CV seems to have chosen a different model where p=8. Thus, we’ll create models for p=1,5,8.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">=</span> <span class="dv">5</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>best_performance <span class="ot">&lt;-</span> <span class="cn">Inf</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>fold_s <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">nrow</span>(df2_ts)<span class="sc">/</span>folds)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>folds){</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">&lt;-</span> (fold<span class="dv">-1</span>)<span class="sc">*</span>fold_s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  end <span class="ot">&lt;-</span> fold<span class="sc">*</span>fold_s</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  train_model <span class="ot">&lt;-</span> df2_ts[<span class="sc">-</span>(start<span class="sc">:</span>end), ]</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  test_model <span class="ot">&lt;-</span> df2_ts[start<span class="sc">:</span>end, ]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  sel <span class="ot">&lt;-</span> <span class="fu">VARselect</span>(train_model, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"both"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  best_lag <span class="ot">&lt;-</span> sel<span class="sc">$</span>selection[<span class="dv">1</span>]</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(train_model, <span class="at">p=</span>best_lag, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">nrow</span>(test_model)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">n.ahead =</span> h)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  pred_hybe <span class="ot">&lt;-</span> pred<span class="sc">$</span>fcst<span class="sc">$</span>hybe[,<span class="dv">1</span>]</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_hybe <span class="sc">-</span> test_model[, <span class="st">"hybe"</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(mse <span class="sc">&lt;</span> best_performance){</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> fit</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    best_performance <span class="ot">&lt;-</span> mse</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"The best model is: "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The best model is: "</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
VAR Estimation Results:
======================= 

Estimated coefficients for equation hybe: 
========================================= 
Call:
hybe = hybe.l1 + umgp.l1 + sony.l1 + hybe.l2 + umgp.l2 + sony.l2 + hybe.l3 + umgp.l3 + sony.l3 + hybe.l4 + umgp.l4 + sony.l4 + hybe.l5 + umgp.l5 + sony.l5 + const + trend 

      hybe.l1       umgp.l1       sony.l1       hybe.l2       umgp.l2 
 0.8539053638 -1.0215452531  0.2959227054  0.1419579738  2.6318973674 
      sony.l2       hybe.l3       umgp.l3       sony.l3       hybe.l4 
-0.1395902070  0.0738676112 -1.6865398900  0.0609080070  0.0563202021 
      umgp.l4       sony.l4       hybe.l5       umgp.l5       sony.l5 
 2.1966952795 -0.0891748828 -0.1463134011 -2.6688851863 -0.0475171819 
        const         trend 
-3.6915131493  0.0002567314 


Estimated coefficients for equation umgp: 
========================================= 
Call:
umgp = hybe.l1 + umgp.l1 + sony.l1 + hybe.l2 + umgp.l2 + sony.l2 + hybe.l3 + umgp.l3 + sony.l3 + hybe.l4 + umgp.l4 + sony.l4 + hybe.l5 + umgp.l5 + sony.l5 + const + trend 

      hybe.l1       umgp.l1       sony.l1       hybe.l2       umgp.l2 
-1.584725e-04  8.720297e-01 -4.619755e-03  3.142192e-04 -3.027609e-03 
      sony.l2       hybe.l3       umgp.l3       sony.l3       hybe.l4 
 7.597068e-04  3.311097e-05  2.828224e-01 -2.077352e-04 -2.589178e-05 
      umgp.l4       sony.l4       hybe.l5       umgp.l5       sony.l5 
-8.100671e-02  4.979529e-03  2.392913e-05 -8.533814e-02 -1.475128e-03 
        const         trend 
 4.398623e-02 -3.323961e-05 


Estimated coefficients for equation sony: 
========================================= 
Call:
sony = hybe.l1 + umgp.l1 + sony.l1 + hybe.l2 + umgp.l2 + sony.l2 + hybe.l3 + umgp.l3 + sony.l3 + hybe.l4 + umgp.l4 + sony.l4 + hybe.l5 + umgp.l5 + sony.l5 + const + trend 

      hybe.l1       umgp.l1       sony.l1       hybe.l2       umgp.l2 
 0.0338568245  0.6513179059  0.8339387214 -0.0338793911  0.5295159038 
      sony.l2       hybe.l3       umgp.l3       sony.l3       hybe.l4 
 0.1535306456 -0.0082547191 -0.3642386250  0.1164845896  0.0143544606 
      umgp.l4       sony.l4       hybe.l5       umgp.l5       sony.l5 
-0.8837947121 -0.0471415700 -0.0024410786  0.4169332761 -0.0843310946 
        const         trend 
 1.7243762875 -0.0001127991 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Based on the p-values and ACF plots of the residuals, the model where p=5 seems to be the best model for forecasting. the residuals are not correlated and the p-value is significant as it is 0.01918 &lt; 0.05.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">1</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_1, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_1
Chi-squared = 274.17, df = 99, p-value &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"umgp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"sony"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>var_model_2 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_2, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_2
Chi-squared = 90.726, df = 63, p-value = 0.01265</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"umgp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"sony"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>var_model_3 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">8</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>gu.serial <span class="ot">&lt;-</span> <span class="fu">serial.test</span>(var_model_3, <span class="at">lags.pt =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">"PT.asymptotic"</span>) </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>gu.serial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Portmanteau Test (asymptotic)

data:  Residuals of VAR object var_model_3
Chi-squared = 55.819, df = 36, p-value = 0.01863</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"hybe"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"umgp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-8.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gu.serial, <span class="at">names =</span> <span class="st">"sony"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-13-9.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>var_model_1 <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(df2_ts, <span class="at">p=</span><span class="dv">5</span>, <span class="at">type=</span> <span class="st">"both"</span>, <span class="at">season =</span> <span class="cn">NULL</span>, <span class="at">exog =</span> <span class="cn">NULL</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>fit.pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(var_model_1, <span class="at">n.ahead =</span> <span class="dv">365</span>, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fanchart</span>(fit.pr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>From this forecasting into the next year, we can see a strong negative trend for both HYBE and SONY, while UMGP’s stock price remains approximately constant. This prediction is similar to what we found from the previous model, such that HYBE will be experiencing a downward trend in prices for the upcoming year. This may be due to a number of reasons, however, most notably would be that their most successful artist, BTS, are continuing their hiatus as the members of the group complete their mandatory military service in South Korea.</p>
<p>Knowing this downward trend in the stock prices of the biggest performing record music agency, we may start to see a downward shift in KPOP among investors globally. Thus, we may need to discuss the direction of cultural globalization in relation to South Korea.</p>
<hr>
</section>
<section id="foreign-tourism-in-korea-on-cultural-globalization-in-the-usa" class="level2">
<h2 class="anchored" data-anchor-id="foreign-tourism-in-korea-on-cultural-globalization-in-the-usa">(3) - Foreign tourism in Korea on Cultural Globalization in the USA</h2>
<p>Let’s see if the cultural globalization index in relation to tourism in South Korea will be trending downward in relation to our previous forecasting.</p>
<p>We’ll combine the globalization index data from KOF with the South Korean tourism data from Statistica.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
   Year tourists KOFCuGIdf
  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1  2000  5320000      75.0
2  2001  5150000      76.9
3  2002  5350000      76.7
4  2003  4750000      77.3
5  2004  5810000      80.8
6  2005  6020000      86.5</code></pre>
</div>
</div>
<p>As discussed previously, we will be modeling the cultural globalization index quantified by KOF within the United States in conjunction with tourism with South Korea throughout the 21st century. As we are focusing on KPOP’s influence within the United States, an integral part of globalization and cultural exchange is through tourism. Thus, looking at the relationship between tourism into South Korea and global culture in the United States will further help to understand this exchange in culture.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Using Auto.Arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Model Fits</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">Final Model Fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>From the graph above, we can see a similar positive trend between both the globalization index and tourists entering South Korea. However, tourism takes a sharp downward trend in 2020. This is, of course, due to the COVID-19 global pandemic that prevented all travel into South Korea from foreigners. Since this data point is an anomaly to determine cultural trends, will continue this model without 2020.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>global_ts <span class="ot">&lt;-</span><span class="fu">ts</span>(df3, <span class="at">start =</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(global_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Cultural Globalization in USA and Tourism in South Korea"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Now, let’s move on with the ARIMAX/ARMAX model. First, we’ll create a model using auto.arima().</p>
<p>Based on the summary statistics of the model created, auto.arima() created the model ARMA(2,0). Additionally, there is no cross correlation in the residuals and the p-value based in the Ljung-Box test is significant.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(global_ts[, <span class="st">"KOFCuGIdf"</span>], <span class="at">xreg =</span> global_ts[, <span class="st">"tourists"</span>])</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: global_ts[, "KOFCuGIdf"] 
Regression with ARIMA(2,0,0) errors 

Coefficients:
         ar1      ar2  intercept  xreg
      1.6838  -0.7370    87.7759     0
s.e.  0.1365   0.1434     0.4453     0

sigma^2 = 2.666:  log likelihood = -38.14
AIC=86.28   AICc=90.57   BIC=91.26

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE      MASE      ACF1
Training set 0.2527717 1.460494 1.089386 0.2644077 1.265622 0.9198188 0.1042156</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(2,0,0) errors
Q* = 7.4991, df = 3, p-value = 0.05758

Model df: 2.   Total lags used: 5</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>We’ll move now to find the ARMAX model manually. Let’s start by taking creating a regression model of tourism on cultural globalization. Using that model, we’ll take the residuals and test multiple Arima models in order to find the one with the lowest AIC and BIC values. From there, after analyzing the residuals and significance of the variables, we’ll validate the model through cross validation.</p>
<p>From the residuals, we can see that there is no cross correlation between the residuals within the ACF plot. Thus, we can move on to manually simulating ARMA models, since we do not need to difference the data.</p>
<p>From the manual process, we can see the models produced with the lowest AIC and BIC values are ARMA(2,2) and ARMA(1,0).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df3<span class="sc">$</span>tourists <span class="ot">&lt;-</span><span class="fu">ts</span>(df3<span class="sc">$</span>tourists, <span class="at">start=</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df3<span class="sc">$</span>KOFCuGIdf <span class="ot">&lt;-</span><span class="fu">ts</span>(df3<span class="sc">$</span>KOFCuGIdf, <span class="at">start=</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>fit.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(KOFCuGIdf <span class="sc">~</span> tourists, <span class="at">data =</span> df3)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = KOFCuGIdf ~ tourists, data = df3)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.2468 -4.0753  0.9324  3.8493  8.2528 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 7.783e+01  3.063e+00   25.41  1.5e-15 ***
tourists    1.202e-06  2.918e-07    4.12 0.000644 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.468 on 18 degrees of freedom
Multiple R-squared:  0.4853,    Adjusted R-squared:  0.4567 
F-statistic: 16.97 on 1 and 18 DF,  p-value: 0.0006436</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>res.fit<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit.reg), <span class="at">start=</span> <span class="dv">2000</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">25</span>),<span class="at">nrow=</span><span class="dv">25</span>) <span class="co"># roughly nrow = 5x2 (see below)</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>)<span class="co"># p=0,1,2,3,4 : 5</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>)<span class="co"># q=0,1,2,3,4 :5</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(res.fit, <span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(output)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">127.2329</td>
<td style="text-align: right;">130.2201</td>
<td style="text-align: right;">128.7329</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">116.8798</td>
<td style="text-align: right;">120.8627</td>
<td style="text-align: right;">119.5464</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">111.9461</td>
<td style="text-align: right;">116.9248</td>
<td style="text-align: right;">116.2318</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">109.5787</td>
<td style="text-align: right;">115.5531</td>
<td style="text-align: right;">116.0402</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">111.3460</td>
<td style="text-align: right;">118.3162</td>
<td style="text-align: right;">120.6794</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">106.7209</td>
<td style="text-align: right;">110.7039</td>
<td style="text-align: right;">109.3876</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">108.4723</td>
<td style="text-align: right;">113.4510</td>
<td style="text-align: right;">112.7580</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">108.4037</td>
<td style="text-align: right;">114.3781</td>
<td style="text-align: right;">114.8653</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">110.3598</td>
<td style="text-align: right;">117.3299</td>
<td style="text-align: right;">119.6931</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">112.3462</td>
<td style="text-align: right;">120.3121</td>
<td style="text-align: right;">125.4371</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">108.2759</td>
<td style="text-align: right;">113.2546</td>
<td style="text-align: right;">112.5616</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">105.2455</td>
<td style="text-align: right;">111.2199</td>
<td style="text-align: right;">111.7071</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">104.8959</td>
<td style="text-align: right;">111.8660</td>
<td style="text-align: right;">114.2292</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">112.2294</td>
<td style="text-align: right;">120.1952</td>
<td style="text-align: right;">125.3203</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">114.0108</td>
<td style="text-align: right;">122.9724</td>
<td style="text-align: right;">132.0108</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">107.7495</td>
<td style="text-align: right;">113.7239</td>
<td style="text-align: right;">114.2110</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">105.8867</td>
<td style="text-align: right;">112.8568</td>
<td style="text-align: right;">115.2200</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">112.1006</td>
<td style="text-align: right;">120.0664</td>
<td style="text-align: right;">125.1915</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">113.3105</td>
<td style="text-align: right;">122.2721</td>
<td style="text-align: right;">131.3105</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">115.3092</td>
<td style="text-align: right;">125.2666</td>
<td style="text-align: right;">139.7537</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">109.2205</td>
<td style="text-align: right;">116.1906</td>
<td style="text-align: right;">118.5538</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">111.1023</td>
<td style="text-align: right;">119.0682</td>
<td style="text-align: right;">124.1932</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">113.2815</td>
<td style="text-align: right;">122.2431</td>
<td style="text-align: right;">131.2815</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">111.4614</td>
<td style="text-align: right;">121.4187</td>
<td style="text-align: right;">135.9058</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">111.5921</td>
<td style="text-align: right;">122.5452</td>
<td style="text-align: right;">144.5921</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC     BIC     AICc
13 2 0 2 104.8959 111.866 114.2292</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 1 0 0 106.7209 110.7039 109.3876</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
6 1 0 0 106.7209 110.7039 109.3876</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>From the following residual plots, we can say that model ARMA(1,0) is the better of the two models due to the lack of cross correlation between the residuals. However, we’ll move onto cross validation in order to determine which of the ARMAX models are the best for forecasting.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "initial  value 1.585318 "                                                              
 [2] "iter   2 value 1.000819"                                                               
 [3] "iter   3 value 0.979873"                                                               
 [4] "iter   4 value 0.971786"                                                               
 [5] "iter   5 value 0.970922"                                                               
 [6] "iter   6 value 0.970615"                                                               
 [7] "iter   7 value 0.970607"                                                               
 [8] "iter   8 value 0.970607"                                                               
 [9] "iter   8 value 0.970607"                                                               
[10] "iter   8 value 0.970607"                                                               
[11] "final  value 0.970607 "                                                                
[12] "converged"                                                                             
[13] "initial  value 1.116539 "                                                              
[14] "iter   2 value 1.064095"                                                               
[15] "iter   3 value 1.062560"                                                               
[16] "iter   4 value 1.061681"                                                               
[17] "iter   5 value 1.061650"                                                               
[18] "iter   6 value 1.061650"                                                               
[19] "iter   6 value 1.061650"                                                               
[20] "final  value 1.061650 "                                                                
[21] "converged"                                                                             
[22] "$fit"                                                                                  
[23] ""                                                                                      
[24] "Call:"                                                                                 
[25] "arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), "
[26] "    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, "       
[27] "    optim.control = list(trace = trc, REPORT = 1, reltol = tol))"                      
[28] ""                                                                                      
[29] "Coefficients:"                                                                         
[30] "         ar1    xmean"                                                                 
[31] "      0.8652  -2.5386"                                                                 
[32] "s.e.  0.1038   3.8694"                                                                 
[33] ""                                                                                      
[34] "sigma^2 estimated as 7.801:  log likelihood = -49.61,  aic = 105.22"                   
[35] ""                                                                                      
[36] "$degrees_of_freedom"                                                                   
[37] "[1] 18"                                                                                
[38] ""                                                                                      
[39] "$ttable"                                                                               
[40] "      Estimate     SE t.value p.value"                                                 
[41] "ar1     0.8652 0.1038  8.3328  0.0000"                                                 
[42] "xmean  -2.5386 3.8694 -0.6561  0.5201"                                                 
[43] ""                                                                                      
[44] "$AIC"                                                                                  
[45] "[1] 5.261176"                                                                          
[46] ""                                                                                      
[47] "$AICc"                                                                                 
[48] "[1] 5.29647"                                                                           
[49] ""                                                                                      
[50] "$BIC"                                                                                  
[51] "[1] 5.410536"                                                                          
[52] ""                                                                                      </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "initial  value 1.553778 "                                                              
 [2] "iter   2 value 1.430949"                                                               
 [3] "iter   3 value 1.042676"                                                               
 [4] "iter   4 value 0.993029"                                                               
 [5] "iter   5 value 0.974081"                                                               
 [6] "iter   6 value 0.956070"                                                               
 [7] "iter   7 value 0.949449"                                                               
 [8] "iter   8 value 0.944797"                                                               
 [9] "iter   9 value 0.942595"                                                               
[10] "iter  10 value 0.941319"                                                               
[11] "iter  11 value 0.940887"                                                               
[12] "iter  12 value 0.940866"                                                               
[13] "iter  13 value 0.940866"                                                               
[14] "iter  14 value 0.940865"                                                               
[15] "iter  15 value 0.940862"                                                               
[16] "iter  16 value 0.940853"                                                               
[17] "iter  17 value 0.940845"                                                               
[18] "iter  18 value 0.940830"                                                               
[19] "iter  19 value 0.940820"                                                               
[20] "iter  20 value 0.940818"                                                               
[21] "iter  21 value 0.940816"                                                               
[22] "iter  22 value 0.940816"                                                               
[23] "iter  22 value 0.940816"                                                               
[24] "iter  22 value 0.940816"                                                               
[25] "final  value 0.940816 "                                                                
[26] "converged"                                                                             
[27] "initial  value 1.014365 "                                                              
[28] "iter   2 value 1.000713"                                                               
[29] "iter   3 value 0.998434"                                                               
[30] "iter   4 value 0.997970"                                                               
[31] "iter   5 value 0.997732"                                                               
[32] "iter   6 value 0.997580"                                                               
[33] "iter   7 value 0.997379"                                                               
[34] "iter   8 value 0.997048"                                                               
[35] "iter   9 value 0.996543"                                                               
[36] "iter  10 value 0.995733"                                                               
[37] "iter  11 value 0.991400"                                                               
[38] "iter  12 value 0.985956"                                                               
[39] "iter  13 value 0.981444"                                                               
[40] "iter  14 value 0.974812"                                                               
[41] "iter  15 value 0.971043"                                                               
[42] "iter  16 value 0.960387"                                                               
[43] "iter  17 value 0.955391"                                                               
[44] "iter  18 value 0.944255"                                                               
[45] "iter  19 value 0.918264"                                                               
[46] "iter  20 value 0.911566"                                                               
[47] "iter  21 value 0.908276"                                                               
[48] "iter  22 value 0.904759"                                                               
[49] "iter  23 value 0.902341"                                                               
[50] "iter  24 value 0.902240"                                                               
[51] "iter  25 value 0.902160"                                                               
[52] "iter  26 value 0.901582"                                                               
[53] "iter  27 value 0.900613"                                                               
[54] "iter  28 value 0.900164"                                                               
[55] "iter  29 value 0.900127"                                                               
[56] "iter  30 value 0.900121"                                                               
[57] "iter  31 value 0.900121"                                                               
[58] "iter  32 value 0.900121"                                                               
[59] "iter  32 value 0.900121"                                                               
[60] "iter  32 value 0.900121"                                                               
[61] "final  value 0.900121 "                                                                
[62] "converged"                                                                             
[63] "$fit"                                                                                  
[64] ""                                                                                      
[65] "Call:"                                                                                 
[66] "arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), "
[67] "    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, "       
[68] "    optim.control = list(trace = trc, REPORT = 1, reltol = tol))"                      
[69] ""                                                                                      
[70] "Coefficients:"                                                                         
[71] "         ar1      ar2      ma1     ma2   xmean"                                        
[72] "      1.8206  -0.9472  -1.2918  0.2918  0.4865"                                        
[73] "s.e.  0.0631   0.0603   0.3380  0.2889  0.8530"                                        
[74] ""                                                                                      
[75] "sigma^2 estimated as 4.709:  log likelihood = -46.38,  aic = 104.76"                   
[76] ""                                                                                      
[77] "$degrees_of_freedom"                                                                   
[78] "[1] 15"                                                                                
[79] ""                                                                                      
[80] "$ttable"                                                                               
[81] "      Estimate     SE  t.value p.value"                                                
[82] "ar1     1.8206 0.0631  28.8298  0.0000"                                                
[83] "ar2    -0.9472 0.0603 -15.7180  0.0000"                                                
[84] "ma1    -1.2918 0.3380  -3.8223  0.0017"                                                
[85] "ma2     0.2918 0.2889   1.0100  0.3285"                                                
[86] "xmean   0.4865 0.8530   0.5703  0.5769"                                                
[87] ""                                                                                      
[88] "$AIC"                                                                                  
[89] "[1] 5.238119"                                                                          
[90] ""                                                                                      
[91] "$AICc"                                                                                 
[92] "[1] 5.452405"                                                                          
[93] ""                                                                                      
[94] "$BIC"                                                                                  
[95] "[1] 5.536838"                                                                          
[96] ""                                                                                      </code></pre>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<p>From the cross validation function, we can see that model ARMA(1, 0) is the best model given that the RMSE values are the lowest across the cross folds. Thus, we’ll choose to forecast Korean tourism on cultural globalization in the US via model 1.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(res.fit)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># Assuming 5 is the maximum number of observations for testing</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">15</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">15</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>rmse3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">15</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(res.fit)[<span class="dv">1</span>] <span class="sc">+</span> (k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) {</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the training set</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  train_end <span class="ot">&lt;-</span> st <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit, <span class="at">end =</span> train_end)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the testing set</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  test_start <span class="ot">&lt;-</span> train_end <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  test_end <span class="ot">&lt;-</span> <span class="fu">min</span>(st <span class="sc">+</span> i, <span class="fu">tsp</span>(res.fit)[<span class="dv">2</span>])</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit, <span class="at">start =</span> test_start, <span class="at">end =</span> test_end)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>  fit3 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  fcast3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit3, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>  rmse1[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>  rmse2[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>  rmse3[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast3<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, rmse2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"horizon"</span>, <span class="at">ylab =</span> <span class="st">"RMSE"</span>)</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, rmse1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, rmse3, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"fit2"</span>, <span class="st">"fit1"</span>, <span class="st">"fit3"</span>), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(global_ts[, <span class="st">"KOFCuGIdf"</span>], <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">xreg =</span> global_ts[, <span class="st">"tourists"</span>])</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: global_ts[, "KOFCuGIdf"] 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1  intercept  xreg
      0.9684    84.7153     0
s.e.  0.0398     1.3007     0

sigma^2 = 5.577:  log likelihood = -45.33
AIC=98.66   AICc=101.32   BIC=102.64

Training set error measures:
                    ME     RMSE      MAE       MPE     MAPE    MASE     ACF1
Training set 0.8955075 2.177229 1.295393 0.9914592 1.500592 1.09376 0.462599</code></pre>
</div>
</div>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-7-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>tourists_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(global_ts[, <span class="st">"tourists"</span>]) </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">forecast</span>(tourists_fit)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg=</span>ft<span class="sc">$</span>mean)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Globalization"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tourists_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: global_ts[, "tourists"] 
ARIMA(1,1,0) with drift 

Coefficients:
          ar1     drift
      -0.5710  627170.2
s.e.   0.1837  185981.8

sigma^2 = 1.743e+12:  log likelihood = -293.87
AIC=593.75   AICc=595.35   BIC=596.58

Training set error measures:
                    ME    RMSE      MAE      MPE     MAPE      MASE       ACF1
Training set -15386.25 1217172 961194.1 -2.96541 9.812744 0.7784607 -0.1121698</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We can see that in the next 10 years, globalization within the US with regards to Korea’s tourism of foreigners will see a slight decrease. As we’ve observed in out previous VAR models, this may be due to an incoming disinterest in KPOP as famous groups such as BTS step away from music in the near future and new groups unable to make a significant impact on the Western music industry as BTS has done.</p>
</section>
<section id="kpop-and-musical-characteristsics" class="level2">
<h2 class="anchored" data-anchor-id="kpop-and-musical-characteristsics">(4) KPOP and Musical Characteristsics</h2>
<p>As we saw in <a href="http://shriya-chinthak.georgetown.domains/DSAN_5600/data-visualization.html">Data Visualization</a>, KPOP as a genre seems to be heavily correlated with loudness, energy, and valence. This energetic sound is something that is very characteristic of KPOP, and thus, it will be insightful to note is these factors someone change the prediction of the popularity metric.</p>
<p><em>Please note: As a reminder, due to the recent changes in the Spotify API, popularity score is no longer available for all songs. Thus, in order to represent all the songs of an artist, we extrapolated with linear regression. Additionally, since songs releases are no consistent, we do not have as much data to work with for the four artsist we’re analyzing.</em></p>
<p>To analyze KPOP as a whole, we’ll be taking the average of all metrics per year as well as the average popularity score.</p>
<div class="cell">
<details>
<summary>Data Collection</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>kpop_artists <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BLACKPINK"</span>, <span class="st">"BTS"</span>, <span class="st">"EXO"</span>, <span class="st">"Twice"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>western_artists <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Harry Styles"</span>, <span class="st">"Beyoncé"</span>, <span class="st">"Drake"</span>, <span class="st">"Taylor Swift"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>spotify <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"cleaned_data/spotify_data_cleaned.csv"</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>kpop_arimax <span class="ot">&lt;-</span> spotify <span class="sc">%&gt;%</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">%in%</span> kpop_artists) <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(album_release_year) <span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"instrumentalness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"valence"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"danceability"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"energy"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"loudness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"speechiness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"acousticness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"liveness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"tempo"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"popularity"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">auto.arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Model Fits</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>All musical characteristics do not seem to have a significant trend or patterns in the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>kpop_ts <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax, <span class="at">start =</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co">#options(repr.plot.width=10, repr.plot.height=20)</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(kpop_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Musical Characeristics and Popularity for KPOP Artists"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>The auto.arima() model, similar to our ARIMA model, produced ARIMA(0,0,0). Thus, we’ll continue to explore a linear regression with the model ARIMA(0,0,0).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>instrumentalness <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>instrumentalness, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>valence <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>valence, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>danceability <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>danceability, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>energy <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>energy, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>loudness <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>loudness, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>speechiness <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>speechiness, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>acousticness <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>acousticness, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>liveness <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>liveness, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>tempo <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>tempo, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>kpop_arimax<span class="sc">$</span>popularity <span class="ot">&lt;-</span><span class="fu">ts</span>(kpop_arimax<span class="sc">$</span>popularity, <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(kpop_ts[, <span class="st">"popularity"</span>], <span class="at">xreg =</span> kpop_ts[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)])</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: kpop_ts[, "popularity"] 
Regression with ARIMA(0,0,0) errors 

Coefficients:
      intercept  instrumentalness  valence  danceability    energy  loudness
        45.7616           84.5679  17.6992       -3.2121  -57.3930    0.2070
s.e.     4.9998           20.5542   6.7811        3.7263   19.9552    0.8031
      speechiness  acousticness  liveness   tempo
           9.2107       -3.3351   18.6917  0.5278
s.e.       6.2002        2.8620    6.1590  0.1225

sigma^2 = 0.3514:  log likelihood = 3.33
AIC=15.34   AICc=-248.66   BIC=19.71

Training set error measures:
                      ME      RMSE       MAE           MPE      MAPE       MASE
Training set 8.53615e-10 0.1787393 0.1266793 -0.0005679029 0.1624506 0.08782325
                   ACF1
Training set -0.5743035</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,0,0) errors
Q* = 5.0725, df = 3, p-value = 0.1666

Model df: 0.   Total lags used: 3</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Unfortunetly, while the residuals are not autocorrelated, none of the predictors were deemed significant to the popularity score. Therefore, for the purposes of modeling, we’ll continue was the smallest p-valed predictors intrumentalness and tempo.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>fit.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(popularity <span class="sc">~</span> instrumentalness <span class="sc">+</span> valence <span class="sc">+</span> danceability <span class="sc">+</span> energy <span class="sc">+</span> loudness <span class="sc">+</span> speechiness <span class="sc">+</span> acousticness <span class="sc">+</span> liveness <span class="sc">+</span> tempo, <span class="at">data =</span> kpop_arimax)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popularity ~ instrumentalness + valence + danceability + 
    energy + loudness + speechiness + acousticness + liveness + 
    tempo, data = kpop_arimax)

Residuals:
        1         2         3         4         5         6         7         8 
-0.144760  0.139854  0.008302  0.081926 -0.019960  0.055501  0.212295 -0.461506 
        9        10        11 
 0.198858 -0.018464 -0.052047 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)       45.7616    16.5817   2.760    0.221
instrumentalness  84.5679    68.1670   1.241    0.432
valence           17.6992    22.4892   0.787    0.576
danceability      -3.2121    12.3582  -0.260    0.838
energy           -57.3930    66.1806  -0.867    0.545
loudness           0.2070     2.6635   0.078    0.951
speechiness        9.2107    20.5626   0.448    0.732
acousticness      -3.3351     9.4916  -0.351    0.785
liveness          18.6917    20.4261   0.915    0.528
tempo              0.5278     0.4063   1.299    0.418

Residual standard error: 0.5928 on 1 degrees of freedom
Multiple R-squared:  0.9922,    Adjusted R-squared:  0.9217 
F-statistic: 14.07 on 9 and 1 DF,  p-value: 0.2042</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>res.fit<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit.reg), <span class="at">start=</span> <span class="dv">2013</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popularity ~ instrumentalness + tempo, data = kpop_arimax)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0145 -1.0731  0.4156  0.6839  2.4913 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)       21.8460    16.3513   1.336  0.21829   
instrumentalness  57.1824    28.9419   1.976  0.08359 . 
tempo              0.4607     0.1367   3.370  0.00978 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.472 on 8 degrees of freedom
Multiple R-squared:  0.6134,    Adjusted R-squared:  0.5168 
F-statistic: 6.347 on 2 and 8 DF,  p-value: 0.02233</code></pre>
</div>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">9</span>),<span class="at">nrow=</span><span class="dv">9</span>) <span class="co"># roughly nrow = 5x2 (see below)</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)<span class="co"># p=0,1,2,3,4 : 5</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)<span class="co"># q=0,1,2,3,4 :5</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(res.fit, <span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(output)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">41.94197</td>
<td style="text-align: right;">43.13566</td>
<td style="text-align: right;">45.37054</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">43.94143</td>
<td style="text-align: right;">45.53301</td>
<td style="text-align: right;">50.60809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">43.37163</td>
<td style="text-align: right;">45.36111</td>
<td style="text-align: right;">55.37163</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">43.94155</td>
<td style="text-align: right;">45.53313</td>
<td style="text-align: right;">50.60821</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45.56530</td>
<td style="text-align: right;">47.55478</td>
<td style="text-align: right;">57.56530</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">45.32442</td>
<td style="text-align: right;">47.71179</td>
<td style="text-align: right;">66.32442</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">45.83803</td>
<td style="text-align: right;">47.82750</td>
<td style="text-align: right;">57.83803</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">44.47938</td>
<td style="text-align: right;">46.86675</td>
<td style="text-align: right;">65.47938</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">42.30636</td>
<td style="text-align: right;">45.09162</td>
<td style="text-align: right;">79.63969</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 0 0 0 41.94197 43.13566 45.37054</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 0 0 0 41.94197 43.13566 45.37054</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
1 0 0 0 41.94197 43.13566 45.37054</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<p>The only model selected was ARIMA(0,0,0). However, due to a lack of data, we were unable to capture model diagnostic output for the model ARIMA(0,0,0) on the residuals. Thus, we’ll continue this linear analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<p>Since we’re only looking at one model, there is no need for cross validation. We’ll continue to forecasting this model.</p>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(kpop_ts[, <span class="st">"popularity"</span>], <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">xreg =</span> kpop_ts[, <span class="fu">c</span>(<span class="st">'instrumentalness'</span>, <span class="st">'tempo'</span>)])</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>music_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(kpop_ts[, <span class="st">"instrumentalness"</span>]) </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">forecast</span>(music_fit)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>music_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(kpop_ts[, <span class="st">"tempo"</span>]) </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>ft2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(music_fit)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>xreg <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">INSTRUMENTAL =</span> ft<span class="sc">$</span>mean,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">TEMPO =</span> ft2<span class="sc">$</span>mean)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg=</span>xreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in forecast.forecast_ARIMA(fit, xreg = xreg): xreg contains different
column names from the xreg used in training. Please check that the regressors
are in the same order.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Popularity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Unfortunetly, due to the limitations of the dataset, we were unable to accurately predict popularity based on musical characteristics. However, some insights were that while tempo and instrumentalness were siginificant on their own at 90% confidence to the popularity, as a whole, the musical characteristics weren’t significant to the popularity.</p>
</section>
<section id="western-artists-discography-and-musical-characteristsics" class="level2">
<h2 class="anchored" data-anchor-id="western-artists-discography-and-musical-characteristsics">(5) Western Artists’ Discography and Musical Characteristsics</h2>
<p>As western artists have dominated the global sphere for decades, it would be interesting to understand if there are specific musical qualities that attribute to this popularity and fame.</p>
<div class="cell">
<details>
<summary>Data Collection</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>western_arimax <span class="ot">&lt;-</span> spotify <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">%in%</span> western_artists) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(album_release_year) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"instrumentalness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"valence"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"danceability"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"energy"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"loudness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"speechiness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"acousticness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"liveness"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"tempo"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"popularity"</span>), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Visualization</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">auto.arima()</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Manual Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Model Fits</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">CV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false">Final Model Fit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false">Forecasting</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Similarly to KPOP, we cannot see ask specific trends of patterns in this data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>western_ts <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax, <span class="at">start =</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co">#options(repr.plot.width=10, repr.plot.height=20)</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(western_ts[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)], <span class="at">facets=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Musical Characeristics and Popularity for Western Artists"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Based on our data, auto.arima() suggests the model ARIMA(0,0,0). This may be due to the fact that musical characteristics do not effect popularity. We’ll look to out manual approach for other conclusions.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>instrumentalness <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>instrumentalness, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>valence <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>valence, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>danceability <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>danceability, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>energy <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>energy, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>loudness <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>loudness, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>speechiness <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>speechiness, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>acousticness <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>acousticness, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>liveness <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>liveness, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>tempo <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>tempo, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>western_arimax<span class="sc">$</span>popularity <span class="ot">&lt;-</span><span class="fu">ts</span>(western_arimax<span class="sc">$</span>popularity, <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(western_ts[, <span class="st">"popularity"</span>], <span class="at">xreg =</span> western_ts[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)])</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: western_ts[, "popularity"] 
Regression with ARIMA(0,0,0) errors 

Coefficients:
      intercept  instrumentalness  valence  danceability   energy  loudness
        29.2442           25.4228   2.7944       19.9559  22.4109   -3.0023
s.e.     6.1730            4.9852   2.5866        4.9131   4.8018    0.2193
      speechiness  acousticness  liveness   tempo
          -10.654        3.4309    4.8872  0.0460
s.e.        2.557        1.7774    3.5788  0.0196

sigma^2 = 0.5384:  log likelihood = -13.98
AIC=49.96   AICc=87.67   BIC=60.35

Training set error measures:
                        ME      RMSE       MAE          MPE      MAPE
Training set -1.709042e-12 0.5050281 0.3581341 -0.003699454 0.4203044
                   MASE       ACF1
Training set 0.09900813 -0.2665946</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Regression with ARIMA(0,0,0) errors
Q* = 12.278, df = 4, p-value = 0.0154

Model df: 0.   Total lags used: 4</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>After regressing on the musical characteristics, it was found that instrumentalness, danceability, energy, loudness, and speechiness were significant to the popularity score. The residuals of the narrowed done model were approximately siginificant. Thus, using those residuals, the model we found manually was ARIMA(0,0,1), which produces a much smaller AIC, BIC, and high p-values in the Ljung-Box statistic test.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="do">############# First fit the linear model##########</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>fit.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(popularity <span class="sc">~</span> instrumentalness <span class="sc">+</span> valence <span class="sc">+</span> danceability <span class="sc">+</span> energy <span class="sc">+</span> loudness <span class="sc">+</span> speechiness <span class="sc">+</span> acousticness <span class="sc">+</span> liveness <span class="sc">+</span> tempo, <span class="at">data =</span> western_ts)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popularity ~ instrumentalness + valence + danceability + 
    energy + loudness + speechiness + acousticness + liveness + 
    tempo, data = western_ts)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.21304 -0.22353 -0.02568  0.18434  1.03858 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       29.24416    8.96907   3.261  0.00983 ** 
instrumentalness  25.42282    7.24327   3.510  0.00662 ** 
valence            2.79438    3.75825   0.744  0.47612    
danceability      19.95588    7.13849   2.796  0.02086 *  
energy            22.41091    6.97679   3.212  0.01062 *  
loudness          -3.00235    0.31865  -9.422 5.86e-06 ***
speechiness      -10.65397    3.71518  -2.868  0.01855 *  
acousticness       3.43089    2.58246   1.329  0.21670    
liveness           4.88717    5.19989   0.940  0.37183    
tempo              0.04601    0.02841   1.619  0.13980    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7338 on 9 degrees of freedom
Multiple R-squared:  0.9739,    Adjusted R-squared:  0.9478 
F-statistic: 37.31 on 9 and 9 DF,  p-value: 4.605e-06</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>res.fit<span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">residuals</span>(fit.reg), <span class="at">start=</span> <span class="dv">2003</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(res.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popularity ~ instrumentalness + danceability + energy + 
    loudness + speechiness, data = western_arimax)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1513 -0.4876  0.0740  0.2559  1.2475 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       41.7766     6.8559   6.094 3.82e-05 ***
instrumentalness  27.6554     6.7584   4.092  0.00127 ** 
danceability      12.0556     4.4759   2.693  0.01842 *  
energy            22.4650     5.6606   3.969  0.00160 ** 
loudness          -3.0750     0.2824 -10.888 6.65e-08 ***
speechiness       -9.7780     3.3741  -2.898  0.01246 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7755 on 13 degrees of freedom
Multiple R-squared:  0.9579,    Adjusted R-squared:  0.9417 
F-statistic: 59.15 on 5 and 13 DF,  p-value: 1.753e-08</code></pre>
</div>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">9</span>),<span class="at">nrow=</span><span class="dv">9</span>) <span class="co"># roughly nrow = 5x2 (see below)</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)<span class="co"># p=0,1,2,3,4 : 5</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)<span class="co"># q=0,1,2,3,4 :5</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(res.fit, <span class="at">order=</span><span class="fu">c</span>(p,d,q),<span class="at">include.drift=</span><span class="cn">TRUE</span>) </span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>    ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p,d,q,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(output)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">43.03641</td>
<td style="text-align: right;">45.86973</td>
<td style="text-align: right;">44.63641</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">32.70444</td>
<td style="text-align: right;">36.48220</td>
<td style="text-align: right;">35.56158</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">34.36021</td>
<td style="text-align: right;">39.08240</td>
<td style="text-align: right;">38.97559</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">42.10240</td>
<td style="text-align: right;">45.88016</td>
<td style="text-align: right;">44.95955</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">34.58239</td>
<td style="text-align: right;">39.30459</td>
<td style="text-align: right;">39.19778</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">36.69395</td>
<td style="text-align: right;">42.36058</td>
<td style="text-align: right;">43.69395</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">38.46446</td>
<td style="text-align: right;">43.18666</td>
<td style="text-align: right;">43.07985</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">34.17954</td>
<td style="text-align: right;">39.84618</td>
<td style="text-align: right;">41.17954</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">36.16657</td>
<td style="text-align: right;">42.77764</td>
<td style="text-align: right;">46.34839</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC     BIC     AICc
2 0 0 1 32.70444 36.4822 35.56158</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC     BIC     AICc
2 0 0 1 32.70444 36.4822 35.56158</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC     BIC     AICc
2 0 0 1 32.70444 36.4822 35.56158</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>The model ARIMA(0,0,1) works siginificantly better than ARIMA(0,0,0) due to the lower AIC, BIC, and AICc numbers.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "initial  value -0.444053 "                                                             
  [2] "iter   2 value -0.584053"                                                              
  [3] "iter   3 value -0.711732"                                                              
  [4] "iter   4 value -0.761423"                                                              
  [5] "iter   5 value -0.803378"                                                              
  [6] "iter   6 value -0.824293"                                                              
  [7] "iter   7 value -0.835056"                                                              
  [8] "iter   8 value -0.850105"                                                              
  [9] "iter   9 value -0.856745"                                                              
 [10] "iter  10 value -0.873162"                                                              
 [11] "iter  11 value -0.907580"                                                              
 [12] "iter  12 value -0.939204"                                                              
 [13] "iter  13 value -0.939504"                                                              
 [14] "iter  14 value -0.942382"                                                              
 [15] "iter  15 value -0.947395"                                                              
 [16] "iter  16 value -0.957184"                                                              
 [17] "iter  17 value -0.958494"                                                              
 [18] "iter  18 value -0.960669"                                                              
 [19] "iter  19 value -0.961846"                                                              
 [20] "iter  20 value -0.963423"                                                              
 [21] "iter  21 value -0.964349"                                                              
 [22] "iter  22 value -0.966120"                                                              
 [23] "iter  23 value -0.966716"                                                              
 [24] "iter  24 value -0.968789"                                                              
 [25] "iter  25 value -0.969010"                                                              
 [26] "iter  26 value -0.971421"                                                              
 [27] "iter  27 value -0.971905"                                                              
 [28] "iter  28 value -0.971958"                                                              
 [29] "iter  29 value -0.972358"                                                              
 [30] "iter  30 value -0.972492"                                                              
 [31] "iter  31 value -0.972897"                                                              
 [32] "iter  32 value -0.973022"                                                              
 [33] "iter  33 value -0.973421"                                                              
 [34] "iter  34 value -0.973551"                                                              
 [35] "iter  35 value -0.973946"                                                              
 [36] "iter  36 value -0.974080"                                                              
 [37] "iter  37 value -0.974471"                                                              
 [38] "iter  38 value -0.974609"                                                              
 [39] "iter  39 value -0.974995"                                                              
 [40] "iter  40 value -0.975136"                                                              
 [41] "iter  41 value -0.975518"                                                              
 [42] "iter  42 value -0.975664"                                                              
 [43] "iter  43 value -0.976041"                                                              
 [44] "iter  44 value -0.976190"                                                              
 [45] "iter  45 value -0.976562"                                                              
 [46] "iter  46 value -0.976716"                                                              
 [47] "iter  47 value -0.977083"                                                              
 [48] "iter  48 value -0.977242"                                                              
 [49] "iter  49 value -0.977604"                                                              
 [50] "iter  50 value -0.977767"                                                              
 [51] "iter  51 value -0.978123"                                                              
 [52] "iter  52 value -0.978291"                                                              
 [53] "iter  53 value -0.978642"                                                              
 [54] "iter  54 value -0.978814"                                                              
 [55] "iter  55 value -0.979161"                                                              
 [56] "iter  56 value -0.979337"                                                              
 [57] "iter  57 value -0.979678"                                                              
 [58] "iter  58 value -0.979859"                                                              
 [59] "iter  59 value -0.980194"                                                              
 [60] "iter  60 value -0.980380"                                                              
 [61] "iter  61 value -0.980710"                                                              
 [62] "iter  62 value -0.980901"                                                              
 [63] "iter  63 value -0.981225"                                                              
 [64] "iter  64 value -0.981421"                                                              
 [65] "iter  65 value -0.981739"                                                              
 [66] "iter  66 value -0.981940"                                                              
 [67] "iter  67 value -0.982252"                                                              
 [68] "iter  68 value -0.982458"                                                              
 [69] "iter  69 value -0.982765"                                                              
 [70] "iter  70 value -0.982975"                                                              
 [71] "iter  71 value -0.983276"                                                              
 [72] "iter  72 value -0.983492"                                                              
 [73] "iter  73 value -0.983787"                                                              
 [74] "iter  74 value -0.984008"                                                              
 [75] "iter  75 value -0.984296"                                                              
 [76] "iter  76 value -0.984522"                                                              
 [77] "iter  77 value -0.984805"                                                              
 [78] "iter  78 value -0.985036"                                                              
 [79] "iter  79 value -0.985312"                                                              
 [80] "iter  80 value -0.985549"                                                              
 [81] "iter  81 value -0.985819"                                                              
 [82] "iter  82 value -0.986061"                                                              
 [83] "iter  83 value -0.986324"                                                              
 [84] "iter  84 value -0.986572"                                                              
 [85] "iter  85 value -0.986829"                                                              
 [86] "iter  86 value -0.987082"                                                              
 [87] "iter  87 value -0.987332"                                                              
 [88] "iter  88 value -0.987590"                                                              
 [89] "iter  89 value -0.987834"                                                              
 [90] "iter  90 value -0.988098"                                                              
 [91] "iter  91 value -0.988335"                                                              
 [92] "iter  92 value -0.988604"                                                              
 [93] "iter  93 value -0.988835"                                                              
 [94] "iter  94 value -0.989110"                                                              
 [95] "iter  95 value -0.989334"                                                              
 [96] "iter  96 value -0.989614"                                                              
 [97] "iter  97 value -0.989831"                                                              
 [98] "iter  98 value -0.990116"                                                              
 [99] "iter  99 value -0.990327"                                                              
[100] "iter 100 value -0.990618"                                                              
[101] "final  value -0.990618 "                                                               
[102] "stopped after 100 iterations"                                                          
[103] "initial  value -0.444053 "                                                             
[104] "iter   2 value -0.580107"                                                              
[105] "iter   3 value -0.616594"                                                              
[106] "iter   4 value -0.653531"                                                              
[107] "iter   5 value -0.675354"                                                              
[108] "iter   6 value -0.700842"                                                              
[109] "iter   7 value -0.718002"                                                              
[110] "iter   8 value -0.729862"                                                              
[111] "iter   9 value -0.735738"                                                              
[112] "iter  10 value -0.736471"                                                              
[113] "iter  11 value -0.736813"                                                              
[114] "iter  12 value -0.736814"                                                              
[115] "iter  13 value -0.736818"                                                              
[116] "iter  14 value -0.736819"                                                              
[117] "iter  14 value -0.736819"                                                              
[118] "iter  14 value -0.736819"                                                              
[119] "final  value -0.736819 "                                                               
[120] "converged"                                                                             
[121] "$fit"                                                                                  
[122] ""                                                                                      
[123] "Call:"                                                                                 
[124] "arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), "
[125] "    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, "       
[126] "    optim.control = list(trace = trc, REPORT = 1, reltol = tol))"                      
[127] ""                                                                                      
[128] "Coefficients:"                                                                         
[129] "          ma1   xmean"                                                                 
[130] "      -1.0000  0.0079"                                                                 
[131] "s.e.   0.1608  0.0172"                                                                 
[132] ""                                                                                      
[133] "sigma^2 estimated as 0.1957:  log likelihood = -12.96,  aic = 31.92"                   
[134] ""                                                                                      
[135] "$degrees_of_freedom"                                                                   
[136] "[1] 17"                                                                                
[137] ""                                                                                      
[138] "$ttable"                                                                               
[139] "      Estimate     SE t.value p.value"                                                 
[140] "ma1    -1.0000 0.1608 -6.2187  0.0000"                                                 
[141] "xmean   0.0079 0.0172  0.4582  0.6526"                                                 
[142] ""                                                                                      
[143] "$AIC"                                                                                  
[144] "[1] 1.680028"                                                                          
[145] ""                                                                                      
[146] "$AICc"                                                                                 
[147] "[1] 1.719502"                                                                          
[148] ""                                                                                      
[149] "$BIC"                                                                                  
[150] "[1] 1.82915"                                                                           
[151] ""                                                                                      </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">sarima</span>(res.fit, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "initial  value -0.444053 "                                                             
 [2] "iter   1 value -0.444053"                                                              
 [3] "final  value -0.444053 "                                                               
 [4] "converged"                                                                             
 [5] "initial  value -0.444053 "                                                             
 [6] "iter   1 value -0.444053"                                                              
 [7] "final  value -0.444053 "                                                               
 [8] "converged"                                                                             
 [9] "$fit"                                                                                  
[10] ""                                                                                      
[11] "Call:"                                                                                 
[12] "arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), "
[13] "    xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, "       
[14] "    optim.control = list(trace = trc, REPORT = 1, reltol = tol))"                      
[15] ""                                                                                      
[16] "Coefficients:"                                                                         
[17] "       xmean"                                                                          
[18] "      0.0000"                                                                          
[19] "s.e.  0.1472"                                                                          
[20] ""                                                                                      
[21] "sigma^2 estimated as 0.4114:  log likelihood = -18.52,  aic = 41.05"                   
[22] ""                                                                                      
[23] "$degrees_of_freedom"                                                                   
[24] "[1] 18"                                                                                
[25] ""                                                                                      
[26] "$ttable"                                                                               
[27] "      Estimate     SE t.value p.value"                                                 
[28] "xmean        0 0.1472       0       1"                                                 
[29] ""                                                                                      
[30] "$AIC"                                                                                  
[31] "[1] 2.160296"                                                                          
[32] ""                                                                                      
[33] "$AICc"                                                                                 
[34] "[1] 2.17268"                                                                           
[35] ""                                                                                      
[36] "$BIC"                                                                                  
[37] "[1] 2.259711"                                                                          
[38] ""                                                                                      </code></pre>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<p>Using corss validation, we can confirm that ARIMA(0,0,1), or fit2, is the better model since is stays at a lower RMSE for the majority of the time in the plot below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(res.fit)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Assuming 5 is the maximum number of observations for testing</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>rmse1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">8</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>rmse2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">8</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">tsp</span>(res.fit)[<span class="dv">1</span>] <span class="sc">+</span> (k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the training set</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  train_end <span class="ot">&lt;-</span> st <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>  xtrain <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit, <span class="at">end =</span> train_end)</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the testing set</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>  test_start <span class="ot">&lt;-</span> train_end <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>  test_end <span class="ot">&lt;-</span> <span class="fu">min</span>(st <span class="sc">+</span> i, <span class="fu">tsp</span>(res.fit)[<span class="dv">2</span>])</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>  xtest <span class="ot">&lt;-</span> <span class="fu">window</span>(res.fit, <span class="at">start =</span> test_start, <span class="at">end =</span> test_end)</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>  fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(xtrain, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">include.drift =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>  fcast2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit2, <span class="at">h =</span> <span class="dv">4</span>)</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>  rmse1[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>  rmse2[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((fcast2<span class="sc">$</span>mean <span class="sc">-</span> xtest)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, rmse2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"horizon"</span>, <span class="at">ylab =</span> <span class="st">"RMSE"</span>)</span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, rmse1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"fit2"</span>, <span class="st">"fit1"</span>), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<p>The final fit is ARIMA(0,0,1) of the residuals of regression on popularity with predictors instrumentalness, danceability, energy, loudness, and speechiness.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(western_ts[, <span class="st">"popularity"</span>], <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xreg =</span> western_ts[, <span class="fu">c</span>(<span class="st">'instrumentalness'</span>, <span class="st">'danceability'</span>,<span class="st">'energy'</span>, <span class="st">'loudness'</span>, <span class="st">'speechiness'</span>)])</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: western_ts[, "popularity"] 
Regression with ARIMA(0,0,1) errors 

Coefficients:
          ma1  intercept  instrumentalness  danceability   energy  loudness
      -1.0000    42.7338           30.6405       10.7786  21.7724   -3.1092
s.e.   0.1336     3.9446            4.2529        2.6569   3.4500    0.1412
      speechiness
         -10.2244
s.e.       2.2792

sigma^2 = 0.271:  log likelihood = -11.69
AIC=39.38   AICc=53.78   BIC=46.93

Training set error measures:
                       ME      RMSE       MAE         MPE      MAPE       MASE
Training set -0.009193279 0.4137218 0.3465777 -0.01410969 0.4060604 0.09581328
                   ACF1
Training set -0.2511563</code></pre>
</div>
</div>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>music_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(western_ts[, <span class="st">"instrumentalness"</span>]) </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">forecast</span>(music_fit)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>music_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(western_ts[, <span class="st">"danceability"</span>]) </span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>ft2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(music_fit)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>music_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(western_ts[, <span class="st">"energy"</span>]) </span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>ft3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(music_fit)</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>music_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(western_ts[, <span class="st">"loudness"</span>]) </span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>ft4 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(music_fit)</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>music_fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(western_ts[, <span class="st">"speechiness"</span>]) </span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>ft5 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(music_fit)</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>xreg <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">INSTRUMENTAL =</span> ft<span class="sc">$</span>mean,</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">DANCE =</span> ft2<span class="sc">$</span>mean,</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">ENERGY =</span> ft3<span class="sc">$</span>mean,</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">LOUDNESS =</span> ft4<span class="sc">$</span>mean,</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">SPEECH =</span> ft5<span class="sc">$</span>mean)</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">xreg=</span>xreg)</span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(fcast) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Popularity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="arimax_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>The forecasting for Western Artists with musical charactericals as predictors did enhance the overall predition, we a approximately constant popularity going forward. From this, we could say that popularity for Western artists seems to do more with musical characteristics than KPOP artists. This may be because KPOP artists rise to fame for a variety of reasons, viral music videos, dancing, viral moments, social media presence, and more. Therefore, for KPOP, it may not be a good metric to only use musical characteristics to define popularity.</p>



</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-grammy" class="csl-entry" role="listitem">
<span>“BTS | Artist.”</span> 2022. <a href="https://www.grammy.com/artists/bts/287749" class="uri">https://www.grammy.com/artists/bts/287749</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>